<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mifiel API Documentation</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Raleway:500,700' rel='stylesheet' type='text/css'>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","ruby"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.mifiel.com'>Go to Mifiel.com</a></li>
            <li><a href='mailto:hola@mifiel.com'>Questions? Contact us</a></li>
            <li><a href='https://github.com/Mifiel/api-doc'>Improve this doc</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>Welcome to the Mifiel API! We at Mifiel provide a simple and robust RESTful API enabling any service or company operating in Mexico to integrate electronic signatures (using the FIEL) into their workflow.</p>

<p>Through Mifiel&rsquo;s API, you can easily manage documents and certificates within your Mifiel account.</p>

<h3 id="getting-started">Getting started</h3>

<p>To start using the API you will first need an <em>APP_ID</em> and a <em>APP_SECRET</em> which will be provided upon request (please contact us at <a href="mailto:hola@mifiel.com">hola@mifiel.com</a>).</p>

<p>You will first need to create an account at <a href="https://www.mifiel.com">mifiel.com</a> since the <em>APP_ID</em> and <em>APP_SECRET</em> will be linked to your account. </p>

<p>We have language bindings in Shell and Ruby! You can view code examples on the right (switch between different programming languages using the tabs on top).</p>

<h3 id="api-versions">API Versions</h3>

<p>All API calls are versioned, and the current Mifiel API is v1.0. We will never introduce any breaking changes within any version, but may add new, non-breaking features and enhancements from time to time.</p>

<h2 id="mifiel-supported-sdks">Mifiel-supported SDKs</h2>

<p>We currently suppport only Ruby but are working on adding more languages.</p>

<h3 id="ruby">Ruby</h3>
<pre class="highlight ruby"><code><span class="c1"># Configure Mifiel gem</span>
<span class="no">Mifiel</span><span class="p">.</span><span class="nf">config</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="k">end</span>
</code></pre>

<p>You can find the repo at <a href="https://github.com/Mifiel/ruby-api-client">github.com/Mifiel/ruby-api-client</a></p>

<p>Add this line to your application&rsquo;s Gemfile:</p>

<p><code class="prettyprint">gem &#39;mifiel&#39;</code></p>

<p>Then execute:</p>

<p><code class="prettyprint">$ bundle</code></p>

<p>Or install it yourself as:</p>

<p><code class="prettyprint">$ gem install mifiel</code></p>

<h2 id="authentication">Authentication</h2>

<p>Mifiel uses <strong>SHA1 HMAC encryption</strong> to authenticate API calls. Each request has to be authenticated by following these steps:</p>

<ol>
<li>A canonical string is first created using your HTTP headers containing the
content-type, content-MD5, request URI and the timestamp. You can replace content-type and content-MD5 with a blank string if needed. The timestamp must be a valid HTTP date. The canonical string is computed as follows:</li>
</ol>

<p><code class="prettyprint">canonical_string = &#39;http method,content-type,content-MD5,request URI,timestamp&#39;</code></p>

<ol>
<li><p>This string is then used to create the signature, which is a Base64 encoded
SHA1 HMAC, using the <strong>APP_SECRET</strong> key.</p></li>
<li><p>This signature is then added as the <code class="prettyprint">Authorization</code> HTTP header in the following form:</p></li>
</ol>

<p><code class="prettyprint">Authorization: APIAuth APP-ID:signature-from-step-2</code></p>
<pre class="highlight ruby"><code><span class="n">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
<span class="n">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="n">rest_request</span> <span class="o">=</span> <span class="no">RestClient</span><span class="o">::</span><span class="no">Request</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="ss">url: </span><span class="s1">'https://www.mifiel.com/api/v1/documents'</span><span class="p">,</span>
  <span class="ss">method: :get</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">ApiAuth</span><span class="p">.</span><span class="nf">sign!</span><span class="p">(</span><span class="n">rest_request</span><span class="p">,</span> <span class="n">app_id</span><span class="p">,</span> <span class="n">app_secret</span><span class="p">).</span><span class="nf">execute</span>
<span class="n">json_response</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre>

<h3 id="ruby-example">Ruby Example</h3>

<p>If you are using Ruby, we recommend using our <a href="https://github.com/Mifiel/ruby-api-client">official gem</a>. </p>

<p>If you want to create your own, you can use the <a href="https://github.com/mgomes/api_auth/">api-auth</a> gem which supports many popular HTTP clients. In this example we are using the <a href="https://github.com/rest-client/rest-client">RestClient</a> gem. </p>

          <h1 id="errors">Errors</h1>

<h2 id="error-codes">Error codes</h2>

<p>Mifiel API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request had an error. (more info in the <code class="prettyprint">errors</code> response param)</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your authorization header is wrong.</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required &ndash; Your request needs a paid plan or your paid plan has expired.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified object could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t supported.</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The requested object has been removed from our servers.</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable Entity &ndash; Something happend when we tried to save your request.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem in our servers. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

<h2 id="error-handling">Error Handling</h2>

<p>All errors follow the <a href="http://labs.omniti.com/labs/jsend">JSend</a> specification. Following are examples of error objects found in the body of error responses (<em>e.g. non-200 status code</em>).</p>

<h3 id="when-a-client-sends-an-unexpected-request">When a client sends an unexpected request:</h3>

<blockquote>
<p>JSON Example <strong>fail</strong> response:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fail"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Document#29f3cb01-744d-4eae-8718-213aec8a1678 not found"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code class="prettyprint">fail</code></td>
</tr>
<tr>
<td>errors</td>
<td>Array</td>
<td>Array of error messages</td>
</tr>
</tbody></table>

<h3 id="for-server-errors">For server errors:</h3>

<blockquote>
<p>JSON Example <strong>error</strong> response:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"error"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500: Internal Server Error"</span><span class="w"> 
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code class="prettyprint">error</code></td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>A descriptive message</td>
</tr>
</tbody></table>

          <h1 id="objects">Objects</h1>

<h2 id="document">Document</h2>

<p>Contains information about the PDF file being signed</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"original_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1a580c27d22b432a8c6f4c57aec89dca46bb89b492d3bc537bf90282a6889da"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-pdf.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_by_all"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.921Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Firmado"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/6e0143b0-084b-4b61-800d-486b111b0695/file"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/6e0143b0-084b-4b61-800d-486b111b0695/file?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_signed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/6e0143b0-084b-4b61-800d-486b111b0695/file_signed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_signed_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/6e0143b0-084b-4b61-800d-486b111b0695/file_signed?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_zipped"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/6e0143b0-084b-4b61-800d-486b111b0695/zip"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"certificate_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>original_hash</td>
<td>String</td>
<td>Hash of the original (unsigned) document</td>
</tr>
<tr>
<td>file_file_name</td>
<td>String</td>
<td>Name of the uploaded file</td>
</tr>
<tr>
<td>signed_by_all</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if all signers have signed the document</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of date signed (when all signatures have been collected)</td>
</tr>
<tr>
<td>already_signed</td>
<td>String[]</td>
<td>People that have signed</td>
</tr>
<tr>
<td>has_not_signed</td>
<td>String[]</td>
<td>People that have not signed</td>
</tr>
<tr>
<td>status</td>
<td>Array</td>
<td>[code, code_message] <code class="prettyprint">0: not signed, 1: signed</code></td>
</tr>
<tr>
<td>owner</td>
<td>Object</td>
<td>The owner of the document. The user who created the document.</td>
</tr>
<tr>
<td>file</td>
<td>String</td>
<td>Path where the original document can be downloaded</td>
</tr>
<tr>
<td>file_signed</td>
<td>String</td>
<td>Path where the signed file can be downloaded</td>
</tr>
<tr>
<td>file_zipped</td>
<td>String</td>
<td>Path where the file and signed file in a zip file can be downloaded</td>
</tr>
<tr>
<td>signatures</td>
<td>Object[]</td>
<td>Array of a <a href="#signature">Signature Model</a></td>
</tr>
</tbody></table>

<h2 id="certificate">Certificate</h2>

<p>Contains information regarding the advanced electronic signatures (e.g. FIEL) used to sign the document</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07320f00-f504-47e0-8ff6-78378d2faca4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type_of"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FIEL"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cer_hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"308204cf30...1303030303030323"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JORGE MORALES MENDEZ"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MOMJ811012643"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-28T19:43:23.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate</td>
</tr>
<tr>
<td>type_of</td>
<td>String</td>
<td>Type of certificate used (e.g. FIEL)</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>Name of the owner as defined in the certificate</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC (tax ID) or other identifier of owner as defined in the certificate</td>
</tr>
<tr>
<td>cer_hex</td>
<td>String</td>
<td>Certificate in hexadecimal</td>
</tr>
<tr>
<td>expires_at</td>
<td>Date</td>
<td>Expiration date of the Certificate</td>
</tr>
<tr>
<td>expired</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if the Certificate is expired</td>
</tr>
</tbody></table>

<h2 id="signature">Signature</h2>

<p>Contains information regarding the signers that have successfully signed the document</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"certificate_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signer 1"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate used to sign</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>signed</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if signed</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of the date signed</td>
</tr>
<tr>
<td>certificate_number</td>
<td>String</td>
<td>Certificate number assigned by the certificate authority (e.g. SAT)</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC of the signer</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Electronic signature on the document (in hexadecimal)</td>
</tr>
</tbody></table>

          <h1 id="documents">Documents</h1>

<h2 id="create-a-document">Create a Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">file_contents</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'my-file.pdf'</span><span class="p">)</span>
<span class="n">signers</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="ss">name: </span><span class="s1">'Signer 1'</span><span class="p">,</span> <span class="ss">email: </span><span class="s1">'signer1@email.com'</span> <span class="p">},</span>
  <span class="p">{</span> <span class="ss">name: </span><span class="s1">'Signer 2'</span><span class="p">,</span> <span class="ss">email: </span><span class="s1">'signer2@email.com'</span> <span class="p">}</span>
<span class="p">]</span>
<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">file_contents</span><span class="p">,</span> <span class="n">signers</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST https://www.mifiel.com/api/v1/documents <span class="se">\</span>
  -F <span class="s2">"file=@my-file.pdf"</span> <span class="se">\</span>
  -F <span class="s2">"signatories[0][name]=Signer 1"</span> <span class="se">\</span>
  -F <span class="s2">"signatories[0][email]=signer@email.com"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Create a document to be signed by passing either a PDF file or the Hash of the file.</p>

<p>If you are using our <a href="#widget">embedded signing widget</a>, we suggest that you pass a <strong>File</strong> so that it can be displayed to the end user (signer) within the signing flow on your webpage. Also when using the widget you must pass the <strong>email of the signer</strong> (name is optional) so that we can send them a copy of the signed document when the signing process is complete.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/documents</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td><strong>Optional</strong> File to be signed (The hash will be automatically extracted from the file and signed)</td>
</tr>
<tr>
<td>hash</td>
<td>String</td>
<td><strong>Optional</strong> Hash of the original, unsigned document (The hash will be signed)</td>
</tr>
<tr>
<td>signatories</td>
<td>Array</td>
<td>A list containing the <strong>name</strong>, <strong>tax_id</strong> (RFC) and <strong>email</strong> of each <strong>signer</strong></td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
</tbody></table>

<aside class="info">
  <ul style="margin: 0; padding: 0">
    <li>Either the <b>file</b> or <b>hash</b> must be passed.</li>
    <li>The <b>email</b> in the <b>signatories</b> param is <b>required</b> when using embedded signing.</li>
  </ul>
</aside>

<h3 id="response">Response</h3>

<p>Returns a <a href="#document">Document Model</a></p>

<h2 id="get-a-specific-document">Get a Specific Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="nf">original_hash</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file_signed</span>
<span class="n">document</span><span class="p">.</span><span class="nf">widget_id</span>
<span class="c1"># ...</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to retrieve a specific document.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/documents/:id</code></p>

<h3 id="response">Response</h3>

<p>Returns a <a href="#document">Document Models</a></p>

<h2 id="get-all-documents">Get All Documents</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">documents</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">all</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/documents"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to retrieve all documents in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/documents</code></p>

<h3 id="response">Response</h3>

<p>Returns an Array of <a href="#document">Document Model</a></p>

<h2 id="delete-a-document">Delete a Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X DELETE <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to delete a specific document in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://www.mifiel.com/api/v1/documents/:id</code></p>

<h2 id="sign-a-document">Sign a Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>

<span class="n">private_key</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'FIEL_AAA010101AAA.key'</span><span class="p">)</span>
<span class="n">private_key_pass</span> <span class="o">=</span> <span class="s1">'12345678a'</span>
<span class="n">certificate_id</span> <span class="o">=</span> <span class="s1">'1d041a80-1d50-43ce-8534-64832de3be6b'</span>

<span class="n">document</span><span class="p">.</span><span class="nf">build_signature</span><span class="p">(</span><span class="n">private_key</span><span class="p">,</span> <span class="n">private_key_pass</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="ss">certificate_id: </span><span class="n">certificate_id</span><span class="p">)</span>
<span class="c1"># Or</span>
<span class="n">certificate</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'FIEL_AAA010101AAA.cer'</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="ss">certificate: </span><span class="n">certificate</span><span class="p">)</span>
</code></pre>

<p>Allows the specified document to be signed.</p>

<p>The documents get signed client-side. For security purposes, the private key and password of the signer never reach our server.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/documents/:id/sign</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>certificate_id</td>
<td>String</td>
<td><strong>Optional</strong> The ID of the certificate that corresponds to the private key being used to sign</td>
</tr>
<tr>
<td>certificate</td>
<td>String</td>
<td><strong>Optional</strong> The certificate (.cer file) corresponding to the private key being used to sign</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>The electronic signature on the successfully-signed document</td>
</tr>
</tbody></table>

<aside class="info">
  Either the <b>certificate_id</b> or <b>certificate</b> must be provided.
</aside>

<h3 id="response">Response</h3>

<p>Returns a <a href="#document">Document Model</a></p>

<h2 id="request-signature">Request signature</h2>

<p>Sends an email request for the document to be signed.</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">email</span> <span class="o">=</span> <span class="s1">'signer@email.com'</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'signer@email.com'</span><span class="p">,</span> <span class="s1">'viewer@email.com'</span><span class="p">]</span>
<span class="n">document</span><span class="p">.</span><span class="nf">request_signature</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="ss">cc: </span><span class="n">cc</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678/request_signature"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Correo enviado"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="w">        
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/documents/:id/request_signature</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>cc</td>
<td>String</td>
<td>Email of any non-signing viewers that should receive a copy of the signed document</td>
</tr>
</tbody></table>

          <h1 id="certificates">Certificates</h1>

<p>At the moment we only support signing with the FIEL (the most frequently used advanced electronic signature in Mexico). We will  soon be adding support for additional types of electronic signatures and will update the documentation as we do so.</p>

<h2 id="create-a-certificate">Create a Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">file_contents</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'my-certificate.cer'</span><span class="p">)</span>
<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">file_contents</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST https://www.mifiel.com/api/v1/keys <span class="se">\</span>
  -F <span class="s2">"file=@my-certificate.cer"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Uploads the certificate of a signer in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/keys</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td><code class="prettyprint">.cer</code> File of your FIEL</td>
</tr>
</tbody></table>

<aside class="info">
  You only have to send the public certificate of the signer. We will never store the private key in our servers.
</aside>

<h3 id="response">Response</h3>

<p>Returns a <a href="#certificate">Certificate Model</a></p>

<h2 id="get-a-specific-certificate">Get a Specific Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">type_of</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">owner</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">tax_id</span>
<span class="c1"># ...</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to retrieve a specific certificate.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/keys/:id</code></p>

<h3 id="response">Response</h3>

<p>Returns a <a href="#certificate">Certificate Model</a></p>

<h2 id="get-all-certificates">Get All Certificates</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificates</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">all</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/keys"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to retrieve ALL certificates in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/keys</code></p>

<h3 id="response">Response</h3>

<p>Returns an Array of a <a href="#certificate">Certificate Model</a></p>

<h2 id="delete-a-certificate">Delete a Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X DELETE <span class="s2">"https://www.mifiel.com/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>

<p>Allows you to delete a specific certificate in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://www.mifiel.com/api/v1/keys/:id</code></p>

<h2 id="sat-root-certificates">SAT Root Certificates</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">sat_certificates</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">sat</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/keys/sat"</span>
</code></pre>

<blockquote>
<p>JSON Example response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"cer_hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"505003081ac310b3...009060355040613024d583"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-06-10T19:41:06.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"cer_hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"302d060355040a0...653572766963696f20646520"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-10T09:11:26.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Lists all of the public SAT Certificates used to generate all FIELs</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/keys/:id</code></p>

<h3 id="response-parameters">Response parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cer_hex</td>
<td>HEX</td>
<td>SAT Root Certificate in hex form</td>
</tr>
<tr>
<td>expires_at</td>
<td>Date</td>
<td>Expiration date of the certificate</td>
</tr>
<tr>
<td>expired</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if expires_at is prior to today</td>
</tr>
</tbody></table>

          <h1 id="embedded-signing">Embedded Signing</h1>

<h2 id="widget">Widget</h2>

<blockquote>
<p>Copy this code and paste it just before the <code class="prettyprint">&lt;/body&gt;</code> tag.</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">||</span><span class="p">[],</span><span class="kd">function</span><span class="p">(){</span><span class="s2">"use strict"</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">[</span><span class="s2">"widget"</span><span class="p">],</span><span class="nx">i</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">e</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)))}},</span><span class="nx">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">t</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">t</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">t</span><span class="p">];</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">n</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"mifiel-js"</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"script"</span><span class="p">),</span><span class="nx">o</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"script"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">"text/javascript"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="s2">"mifiel-js"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">"https://www.mifiel.com/sign-widget-v1.0.0.js"</span><span class="p">,</span><span class="nx">o</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">o</span><span class="p">)}}();</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<blockquote>
<p>Then insert the widget in the desired view (page) by including the following snippet:</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">widget</span><span class="p">({</span>
    <span class="na">widgetId</span><span class="p">:</span> <span class="s1">'c8aa73d1-db06-4d18-9f56-196b00f6eb69'</span><span class="p">,</span>
    <span class="na">appendTo</span><span class="p">:</span> <span class="s1">'id-of-the-element-to-append'</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>The widget is an embedded signing tool that we have created to allow your users to sign documents in an iFrame within your page. By embedding this tool, your users can sign seamlessly without having to leave the flow of your website.</p>

<p><em>Note: The signers do not have to have an account in <a href="https://www.mifiel.com">mifiel.com</a></em></p>

<p>To begin, you have to copy and paste our code snippet (<em>shown to your right</em>) into the code of the page where the signing flow will take place.</p>

<p>You can also find the code snippet <a href="https://www.mifiel.com/sign-snippet-v1.0.0.min.js">here</a>.</p>

<h3 id="options">Options</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>widgetId</td>
<td>String</td>
<td></td>
<td>Widget ID. You can get it with <code class="prettyprint">document.widget_id</code> in Ruby</td>
</tr>
<tr>
<td>appendTo</td>
<td>String</td>
<td>body</td>
<td>ID of the element in the page</td>
</tr>
<tr>
<td>width</td>
<td>String</td>
<td>100%</td>
<td><strong>Optional</strong> Width of the widget <strong>[px or %]</strong></td>
</tr>
<tr>
<td>height</td>
<td>String</td>
<td>1100</td>
<td><strong>Optional</strong> Height of the widget <strong>[px]</strong></td>
</tr>
</tbody></table>

<h3 id="event-document-signed-successfully">Event: Document signed successfully</h3>

<blockquote>
<p>Listen for the Success event:</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span>
      <span class="nb">document</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
      <span class="nx">signature</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">signature</span><span class="p">;</span>
  <span class="c1">// document.original_hash</span>
  <span class="c1">// document.file_signed</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>After the user succesfully signs the document we will send back a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a>.</p>

<h2 id="embedded-signing-flow">Embedded Signing Flow</h2>

<p>Following is a more detailed explanation of the steps involved in requesting and executing signatures within the embedded signing widget.</p>

<ol>
<li><p>First, you must pass the <strong>PDF file</strong> that is being signed (converted into a String), along with the following <strong>parameters</strong>: Webhook, email of each signer, and name of each signer (optional).</p></li>
<li><p>Mifiel will return a <strong>document ID</strong>, which you will then need to pass to the widget (running on your website&rsquo;s front-end).</p></li>
<li><p>The signature process then takes place within your website. The signer will be able to preview the document, select the files of their FIEL, and enter the password of their FIEL to sign (during this process Mifiel will be verifying that the FIEL is valid and not expired). </p></li>
<li><p>If successful, the signer will be presented with a page explaining that the signing was successful and that they will receive an email with the signed document. We will also display a confirmation button (e.g. &lsquo;Proceed to next step&rsquo;) which will return the user to the flow of your website.</p></li>
<li><p>Mifiel will then post the following information to the webhook specified by you (in Step 1): electronic signature of the document, timestamp of signature, the signature page, and information regarding the public certificate(s) used to sign the document.</p></li>
</ol>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="ruby">ruby</a>
          </div>
      </div>
    </div>
  </body>
</html>
