
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mifiel API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-2b995209.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-ba0dcb9f.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;,&quot;ruby&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-0a8723bb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-0a8723bb.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="php">PHP</a>
              <a href="#" data-language-name="ruby">Ruby</a>
              <a href="#" data-language-name="python">Python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-versions" class="toc-h2 toc-link" data-title="API Versions">API Versions</a>
                  </li>
                  <li>
                    <a href="#sandbox-enviroment" class="toc-h2 toc-link" data-title="Sandbox enviroment">Sandbox enviroment</a>
                  </li>
                  <li>
                    <a href="#production-enviroment" class="toc-h2 toc-link" data-title="Production enviroment">Production enviroment</a>
                  </li>
                  <li>
                    <a href="#mifiel-supported-sdks" class="toc-h2 toc-link" data-title="Mifiel-supported SDKs">Mifiel-supported SDKs</a>
                  </li>
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="Authentication">Authentication</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#objects" class="toc-h1 toc-link" data-title="Objects">Objects</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#document" class="toc-h2 toc-link" data-title="Document">Document</a>
                  </li>
                  <li>
                    <a href="#endorsable-document" class="toc-h2 toc-link" data-title="Endorsable Document">Endorsable Document</a>
                  </li>
                  <li>
                    <a href="#certificate" class="toc-h2 toc-link" data-title="Certificate">Certificate</a>
                  </li>
                  <li>
                    <a href="#signature" class="toc-h2 toc-link" data-title="Signature">Signature</a>
                  </li>
                  <li>
                    <a href="#template" class="toc-h2 toc-link" data-title="Template">Template</a>
                  </li>
                  <li>
                    <a href="#signatory" class="toc-h2 toc-link" data-title="Signatory">Signatory</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#documents" class="toc-h1 toc-link" data-title="Documents">Documents</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-a-document" class="toc-h2 toc-link" data-title="Create a Document">Create a Document</a>
                  </li>
                  <li>
                    <a href="#get-a-specific-document" class="toc-h2 toc-link" data-title="Get a Specific Document">Get a Specific Document</a>
                  </li>
                  <li>
                    <a href="#get-all-documents" class="toc-h2 toc-link" data-title="Get All Documents">Get All Documents</a>
                  </li>
                  <li>
                    <a href="#delete-a-document" class="toc-h2 toc-link" data-title="Delete a Document">Delete a Document</a>
                  </li>
                  <li>
                    <a href="#request-signature" class="toc-h2 toc-link" data-title="Request signature">Request signature</a>
                  </li>
                  <li>
                    <a href="#transfer-a-document" class="toc-h2 toc-link" data-title="Transfer a document">Transfer a document</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#certificates" class="toc-h1 toc-link" data-title="Certificates">Certificates</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-a-certificate" class="toc-h2 toc-link" data-title="Create a Certificate">Create a Certificate</a>
                  </li>
                  <li>
                    <a href="#get-a-specific-certificate" class="toc-h2 toc-link" data-title="Get a Specific Certificate">Get a Specific Certificate</a>
                  </li>
                  <li>
                    <a href="#get-all-certificates" class="toc-h2 toc-link" data-title="Get All Certificates">Get All Certificates</a>
                  </li>
                  <li>
                    <a href="#delete-a-certificate" class="toc-h2 toc-link" data-title="Delete a Certificate">Delete a Certificate</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#templates" class="toc-h1 toc-link" data-title="Templates">Templates</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-a-template" class="toc-h2 toc-link" data-title="Create a Template">Create a Template</a>
                  </li>
                  <li>
                    <a href="#get-a-specific-template" class="toc-h2 toc-link" data-title="Get a Specific Template">Get a Specific Template</a>
                  </li>
                  <li>
                    <a href="#get-all-templates" class="toc-h2 toc-link" data-title="Get All Templates">Get All Templates</a>
                  </li>
                  <li>
                    <a href="#delete-a-template" class="toc-h2 toc-link" data-title="Delete a Template">Delete a Template</a>
                  </li>
                  <li>
                    <a href="#template-fields" class="toc-h2 toc-link" data-title="Template fields">Template fields</a>
                  </li>
                  <li>
                    <a href="#template-documents" class="toc-h2 toc-link" data-title="Template documents">Template documents</a>
                  </li>
                  <li>
                    <a href="#generate-a-document-from-a-template" class="toc-h2 toc-link" data-title="Generate a document from a template">Generate a document from a template</a>
                  </li>
                  <li>
                    <a href="#generate-several-documents-from-a-template" class="toc-h2 toc-link" data-title="Generate several documents from a template">Generate several documents from a template</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#embedded-signing" class="toc-h1 toc-link" data-title="Embedded Signing">Embedded Signing</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#widget" class="toc-h2 toc-link" data-title="Widget">Widget</a>
                  </li>
                  <li>
                    <a href="#events" class="toc-h2 toc-link" data-title="Events">Events</a>
                  </li>
                  <li>
                    <a href="#embedded-signing-flow" class="toc-h2 toc-link" data-title="Embedded Signing Flow">Embedded Signing Flow</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#endorsables-setup" class="toc-h1 toc-link" data-title="Endorsables setup">Endorsables setup</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#user-account-setup" class="toc-h2 toc-link" data-title="User account setup">User account setup</a>
                  </li>
                  <li>
                    <a href="#require-a-setup-widget-id" class="toc-h2 toc-link" data-title="Require a setup widget id">Require a setup widget id</a>
                  </li>
                  <li>
                    <a href="#user-account-setup-widget" class="toc-h2 toc-link" data-title="User account setup widget">User account setup widget</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#error-codes" class="toc-h2 toc-link" data-title="Error codes">Error codes</a>
                  </li>
                  <li>
                    <a href="#error-handling" class="toc-h2 toc-link" data-title="Error Handling">Error Handling</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.mifiel.com'>Go to Mifiel.com</a></li>
            <li><a href='mailto:hola@mifiel.com'>Questions? Contact us</a></li>
            <li><a href='https://github.com/Mifiel/api-doc'>Improve this doc</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Mifiel API! We at Mifiel provide a simple and robust RESTful API enabling any service or company operating in Mexico to integrate electronic signatures (using the FIEL) into their workflow.</p>

<p>Through Mifiel&#39;s API, you can easily manage documents and certificates within your Mifiel account.</p>

<p>We have language bindings in <strong>Shell</strong>, <strong>PHP</strong>, <strong>Ruby</strong> and <strong>Python</strong>! You can view code examples on the right (switch between different programming languages using the tabs on top).</p>
<h3 id='api-versions'>API Versions</h3>
<p>All API calls are versioned, and the current Mifiel API is v1.0. We will never introduce any breaking changes within any version, but may add new, non-breaking features and enhancements from time to time.</p>
<h3 id='sandbox-enviroment'>Sandbox enviroment</h3>
<p>For your convenience Mifiel offers a Sandbox environment where you can confidently test your code.</p>

<p>To start using the API in the <strong>Sandbox</strong> environment you need to first create an account at <a href="https://sandbox.mifiel.com">sandbox.mifiel.com</a>.</p>

<p>Once you have an account you will need an <em>APP_ID</em> and an <em>APP_SECRET</em> which you can generate in <a href="https://sandbox.mifiel.com/access_tokens">sandbox.mifiel.com/access_tokens</a>.</p>

<p>Just change the <strong>www</strong>.mifiel.com for <strong>sandbox</strong>.mifiel.com in every endpoint that you use.</p>

<aside class="warning">The Sandbox environment is not intended to be used to sign non-test documents. Documents signed in Sandbox will not have the same legal validity as those signed in production.</aside>
<h3 id='production-enviroment'>Production enviroment</h3>
<p>To start using the API in the <strong>Production</strong> environment you need to first create an account at <a href="https://www.mifiel.com">mifiel.com</a>.</p>

<p>Once you have an account you will need an <em>APP_ID</em> and an <em>APP_SECRET</em> which you can generate in <a href="https://www.mifiel.com/access_tokens">mifiel.com/access_tokens</a>.</p>
<h2 id='mifiel-supported-sdks'>Mifiel-supported SDKs</h2>
<p>We currently suppport <strong>Ruby</strong>, <strong>PHP</strong> and <strong>Python</strong> but are working on adding more languages.</p>
<h3 id='ruby'>Ruby</h3><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="c1"># Configure Mifiel gem</span>
<span class="no">Mifiel</span><span class="p">.</span><span class="nf">config</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="k">end</span>
</code></pre></div>
<p>Add this line to your application&#39;s Gemfile:</p>

<p><code>gem &#39;mifiel&#39;</code></p>

<p>Then execute:</p>

<p><code>$ bundle</code></p>

<p>Or install it yourself as:</p>

<p><code>$ gem install mifiel</code></p>

<p>You can find the repo at <a href="https://github.com/Mifiel/ruby-api-client">github.com/Mifiel/ruby-api-client</a>.</p>
<h3 id='php'>PHP</h3><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="c1">// include composer autoload</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>

<span class="c1">// import Mifiel Client Class</span>
<span class="kn">use</span> <span class="nn">Mifiel\ApiClient</span> <span class="k">as</span> <span class="n">Mifiel</span><span class="p">;</span>

<span class="c1">// Configure Mifiel Library</span>
<span class="nx">Mifiel</span><span class="o">::</span><span class="na">setTokens</span><span class="p">(</span><span class="s1">'APP_ID'</span><span class="p">,</span> <span class="s1">'APP_SECRET'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>The best way to install Mifiel is quickly and easily with <a href="https://getcomposer.org">Composer</a>.</p>

<p>To install the most recent version, run the following command.</p>

<p><code>php composer.phar require mifiel/api-client</code> </p>

<p>Now your composer.json has been updated automatically and you&#39;re able to require the just created <em>vendor/autoload.php</em> file to PSR-4 autoload the library.</p>

<p>You can find the repo at <a href="https://github.com/Mifiel/php-api-client">github.com/Mifiel/ruby-api-client</a>.</p>
<h3 id='python'>Python</h3><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># Import the Client 
</span><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="c1"># Configure Mifiel Library, you will 
# pass this to every call you make to our servers.
</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>
<span class="c1"># If you want to make tests without beeing charged
# you can use our sandbox enviroment with:
</span><span class="n">client</span><span class="o">.</span><span class="n">use_sandbox</span>
</code></pre></div>
<p>The best way to install Mifiel lib is with <a href="https://pypi.python.org/pypi">PIP</a>.
To install the most recent version please run the following command.</p>

<p><code>pip install mifiel</code></p>

<p>You can find the repo at <a href="https://github.com/Mifiel/python-api-client/">github.com/Mifiel/python-api-client</a></p>
<h2 id='authentication'>Authentication</h2>
<p>Mifiel uses <strong>SHA1 HMAC encryption</strong> to authenticate API calls. Each request has to be authenticated by following these steps:</p>

<ol>
<li>A canonical string is first created using your HTTP headers containing the
content-type, content-MD5, request URI and the timestamp. You can replace content-type and content-MD5 with a blank string if needed. The timestamp must be a valid HTTP date. The canonical string is computed as follows:</li>
</ol>

<p><code>canonical_string = &#39;http method,content-type,content-MD5,request URI,timestamp&#39;</code></p>

<ol>
<li><p>This string is then used to create the signature, which is a Base64 encoded
SHA1 HMAC, using the <strong>APP_SECRET</strong> key.</p></li>
<li><p>This signature is then added as the <code>Authorization</code> HTTP header in the following form:</p></li>
</ol>

<p><code>Authorization: APIAuth APP-ID:signature-from-step-2</code></p>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="n">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
<span class="n">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="n">rest_request</span> <span class="o">=</span> <span class="no">RestClient</span><span class="o">::</span><span class="no">Request</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="ss">url: </span><span class="s1">'https://www.mifiel.com/api/v1/documents'</span><span class="p">,</span>
  <span class="ss">method: :get</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">ApiAuth</span><span class="p">.</span><span class="nf">sign!</span><span class="p">(</span><span class="n">rest_request</span><span class="p">,</span> <span class="n">app_id</span><span class="p">,</span> <span class="n">app_secret</span><span class="p">).</span><span class="nf">execute</span>
<span class="n">json_response</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div><h3 id='ruby-example'>Ruby Example</h3>
<p>If you are using Ruby, we recommend using our <a href="https://github.com/Mifiel/ruby-api-client">official gem</a>. </p>

<p>If you want to create your own, you can use the <a href="https://github.com/mgomes/api_auth/">api-auth</a> gem which supports many popular HTTP clients. In this example we are using the <a href="https://github.com/rest-client/rest-client">RestClient</a> gem. </p>
<h1 id='objects'>Objects</h1>
<p>Mifiel data is structured around 3 main types of objects: Document, Certificate and Signature. You’ll find these objects in the format described below.</p>

<aside class="info">
  The <b>Date</b> type is always in <b>Coordinated Universal Time (UTC)</b>.
</aside>
<h2 id='document'>Document</h2>
<p>Contains information about the PDF file being signed</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"original_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1a580c27d22b4...c537bf90282a6889da"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-pdf.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signed_by_all"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.921Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Firmado"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.example.com/webhook/url"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_signed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file_signed"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_signed_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file_signed?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_zipped"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../zip"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"certificate_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nl">"widget_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCD1234"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>original_hash</td>
<td>String</td>
<td>Hash of the original (unsigned) document</td>
</tr>
<tr>
<td>file_file_name</td>
<td>String</td>
<td>Name of the uploaded file</td>
</tr>
<tr>
<td>signed_by_all</td>
<td>Boolean</td>
<td><code>true</code> if all signers have signed the document</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of date signed (when all signatures have been collected)</td>
</tr>
<tr>
<td>already_signed</td>
<td>String[]</td>
<td>People that have signed</td>
</tr>
<tr>
<td>has_not_signed</td>
<td>String[]</td>
<td>People that have not signed</td>
</tr>
<tr>
<td>status</td>
<td>Array</td>
<td>[code, code_message] <code>0: not signed, 1: signed</code></td>
</tr>
<tr>
<td>owner</td>
<td>Object</td>
<td>The owner of the document. The user who created the document.</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>The callback URL to be <code>POST</code>ed when everybody signs</td>
</tr>
<tr>
<td>file</td>
<td>String</td>
<td>Path where the original document can be downloaded</td>
</tr>
<tr>
<td>file_signed</td>
<td>String</td>
<td>Path where the signed file can be downloaded</td>
</tr>
<tr>
<td>file_zipped</td>
<td>String</td>
<td>Path where the file and signed file in a zip file can be downloaded</td>
</tr>
<tr>
<td>signatures</td>
<td>Object[]</td>
<td>Array of a <a href="#signature">Signature Model</a></td>
</tr>
<tr>
<td>external_id</td>
<td>String</td>
<td>A unique id for you to identify the document in the response or fetch it</td>
</tr>
</tbody></table>
<h2 id='endorsable-document'>Endorsable Document</h2><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"tracked"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"promissory-note"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"transferable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"asset"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f48732f18l67612427c889ae08789032"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2N2o6xjB1K5uhjg4Zaj8z9EbnGyrqQazpwX"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>An endorsable document is a specific type of document whose ownership can be transferred from one person or party to another. Some examples are promissory notes (pagarés), titles (títulos), or invoices (facturas).</p>

<p>You can know if a document is endorsable by checking the <b>tracked</b> parameter. It will be <b>true</b> if a document pertains to this category.</p>

<p>Contains the same information as the <a href="#document">Document Model</a> with the following extra attributes: </p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tracked</td>
<td>boolean</td>
<td>Always set to true for endorsable documents.</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>The document type that was specified when the endorsable document was created (currently <b>promissory note</b> is the only supported type)</td>
</tr>
<tr>
<td>transferable</td>
<td>boolean</td>
<td>True if the document is able to be endorsed</td>
</tr>
<tr>
<td>asset</td>
<td>Object</td>
<td>Information about the asset</td>
</tr>
</tbody></table>
<h3 id='asset-object'>Asset Object</h3>
<p>The asset object has the following attributes</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>ID of the asset that is assigned to the document</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>The cryptocurrency address that holds the endorsable document</td>
</tr>
</tbody></table>
<h2 id='certificate'>Certificate</h2>
<p>Contains information regarding the advanced electronic signatures (e.g. FIEL) used to sign the document</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07320f00-f504-47e0-8ff6-78378d2faca4"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type_of"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FIEL"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cer_hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"308204cf30...1303030303030323"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JORGE MORALES MENDEZ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MOMJ811012643"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-28T19:43:23.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate</td>
</tr>
<tr>
<td>type_of</td>
<td>String</td>
<td>Type of certificate used (e.g. FIEL)</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>Name of the owner as defined in the certificate</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC (tax ID) or other identifier of owner as defined in the certificate</td>
</tr>
<tr>
<td>cer_hex</td>
<td>String</td>
<td>Certificate in hexadecimal</td>
</tr>
<tr>
<td>expires_at</td>
<td>Date</td>
<td>Expiration date of the Certificate</td>
</tr>
<tr>
<td>expired</td>
<td>Boolean</td>
<td><code>true</code> if the Certificate is expired</td>
</tr>
</tbody></table>
<h2 id='signature'>Signature</h2>
<p>Contains information regarding the signers that have successfully signed the document</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"certificate_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signer 1"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate used to sign</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>signed</td>
<td>Boolean</td>
<td><code>true</code> if signed</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of the date signed</td>
</tr>
<tr>
<td>certificate_number</td>
<td>String</td>
<td>Certificate number assigned by the certificate authority (e.g. SAT)</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC of the signer</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Electronic signature on the document (in hexadecimal)</td>
</tr>
</tbody></table>
<h2 id='template'>Template</h2><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"446e56c9-6df3-444b-ad2b-c582f1fd0dd0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NDA"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Confidential disclosure agreement between two parties"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"has_documents"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"header"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML header"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML content"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"footer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML footer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"csv"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.mifiel.com/api/v1/templates/446e56c9-6df3-444b-ad2b-c582f1fd0dd0/generate_populated_csv"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"446e56c9-6df3-444b-ad2b-c582f1fd0dd0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pagaré"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pagaré between two parties"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"has_documents"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"header"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML header"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML content"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"footer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The HTML footer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"csv"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.mifiel.com/api/v1/templates/446e56c9-6df3-444b-ad2b-c582f1fd0dd0/generate_populated_csv"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tracked"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"promissory-note"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Template</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>The name of the Template</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>The description</td>
</tr>
<tr>
<td>hash_documents</td>
<td>Boolean</td>
<td>Whether the template has documents or not</td>
</tr>
<tr>
<td>header</td>
<td>Text</td>
<td>The Header of the template</td>
</tr>
<tr>
<td>content</td>
<td>Text</td>
<td>The Content of the template</td>
</tr>
<tr>
<td>footer</td>
<td>Text</td>
<td>The Footer of the template</td>
</tr>
<tr>
<td>tracked</td>
<td>Boolean</td>
<td>Whether the template is used to create endorsable (tracked) documents or non-endorsable documents</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>Type of the template if it is tracked. For now, the only value is &#39;promissory-note&#39; (pagaré)</td>
</tr>
</tbody></table>
<h2 id='signatory'>Signatory</h2><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signatory@email.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signatory Name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"beneficiary"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>The email of the signatory</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td><strong>Optional</strong> The name of the signatory</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td><strong>Optional</strong> The tax_id (RFC) of the signatory</td>
</tr>
<tr>
<td>field</td>
<td>String</td>
<td><strong>Optional</strong> The type of signatory.</td>
</tr>
</tbody></table>

<p>The <em>field</em> param is required in endorsable documents. For example in a promissory note document (created with params <code>track: true, type: &#39;promissory-note&#39;</code>) possible values are <strong>beneficiary</strong> and <strong>subscriber</strong> for issuing and <strong>holder</strong> and <strong>receiver</strong> for transfering.</p>
<h1 id='documents'>Documents</h1><h2 id='create-a-document'>Create a Document</h2>
<blockquote>
<p>Send only <strong>original_hash</strong> and <strong>name</strong> if you dont want us to have the document.</p>
</blockquote>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">track: </span><span class="kp">true</span><span class="p">,</span> <span class="c1"># for endorsable documents only</span>
  <span class="ss">type: </span><span class="s1">'promissory-note'</span><span class="p">,</span> <span class="c1"># for endorsable documents only</span>
  <span class="ss">file: </span><span class="s1">'path/to/my-file.pdf'</span><span class="p">,</span>
  <span class="ss">signatories: </span><span class="p">[{</span> 
    <span class="ss">name: </span><span class="s1">'Signer 1'</span><span class="p">,</span> 
    <span class="ss">email: </span><span class="s1">'signer1@email.com'</span><span class="p">,</span> 
    <span class="ss">tax_id: </span><span class="s1">'AAA010101AAA'</span> 
  <span class="p">},</span> <span class="p">{</span> 
    <span class="ss">name: </span><span class="s1">'Signer 2'</span><span class="p">,</span> 
    <span class="ss">email: </span><span class="s1">'signer2@email.com'</span><span class="p">,</span> 
    <span class="ss">tax_id: </span><span class="s1">'AAA010102AAA'</span> 
  <span class="p">}],</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.example.com/webhook/url'</span>
<span class="p">)</span>

<span class="c1"># if you dont want us to have the PDF, you can send us </span>
<span class="c1"># the original_hash and the name of the document. Both are required</span>
<span class="n">file_contents</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'path/to/my-file.pdf'</span><span class="p">)</span>
<span class="n">original_hash</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(</span><span class="n">file_contents</span><span class="p">)</span>
<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">original_hash: </span><span class="n">original_hash</span><span class="p">,</span>
  <span class="ss">name: </span><span class="s1">'my-file.pdf'</span>
  <span class="ss">signatories: </span><span class="p">[</span> <span class="o">...</span> <span class="p">]</span>
<span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST https://www.mifiel.com/api/v1/documents <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"file=@my-file.pdf"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][name]=Signer 1"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][email]=signer@email.com"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"callback_url=https://www.example.com/webhook/url"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Document</span><span class="p">([</span>
  <span class="s1">'file_path'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/my-file.pdf'</span><span class="p">,</span>
  <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="p">[</span> 
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Signer 1'</span><span class="p">,</span> 
      <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'signer1@email.com'</span><span class="p">,</span> 
      <span class="s1">'tax_id'</span> <span class="o">=&gt;</span>  <span class="s1">'AAA010101AAA'</span> 
    <span class="p">],</span>
    <span class="p">[</span> 
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Signer 2'</span><span class="p">,</span> 
      <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'signer2@email.com'</span><span class="p">,</span> 
      <span class="s1">'tax_id'</span> <span class="o">=&gt;</span>  <span class="s1">'AAA010102AAA'</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]);</span>
<span class="c1">// if you dont want us to have the PDF, you can just send us </span>
<span class="c1">// the original_hash and the name of the document. Both are required</span>
<span class="nv">$document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Document</span><span class="p">([</span>
  <span class="s1">'original_hash'</span> <span class="o">=&gt;</span> <span class="nb">hash</span><span class="p">(</span><span class="s1">'sha256'</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'path/to/my-file.pdf'</span><span class="p">)),</span>
  <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'my-file.pdf'</span><span class="p">,</span>
  <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="o">...</span>
<span class="p">]);</span>

<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">signatories</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> 
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Signer 1'</span><span class="p">,</span> 
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'signer1@email.com'</span><span class="p">,</span> 
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010101AAA'</span> 
  <span class="p">},</span>
  <span class="p">{</span> 
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Signer 2'</span><span class="p">,</span> 
    <span class="s">'email'</span><span class="p">:</span> 
    <span class="s">'signer2@email.com'</span><span class="p">,</span> 
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010102AAA'</span>
  <span class="p">}</span>
<span class="p">]</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> 
  <span class="n">signatories</span><span class="o">=</span><span class="n">signatories</span><span class="p">,</span> 
  <span class="nb">file</span><span class="o">=</span><span class="s">'test/fixtures/example.pdf'</span>
<span class="p">)</span>
<span class="c1"># if you dont want us to have the PDF, you can just send us 
# the original_hash and the name of the document. Both are required
</span><span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> 
  <span class="n">signatories</span><span class="o">=</span><span class="n">signatories</span><span class="p">,</span> 
  <span class="n">dhash</span><span class="o">=</span><span class="s">'some-sha256-hash'</span>
<span class="p">)</span>
</code></pre></div>
<p>Create a document to be signed by passing a PDF file.</p>

<p>If you are using our <a href="#widget">embedded signing widget</a>, we suggest that you pass a <strong>File</strong> so that it can be displayed to the end user (signer) within the signing flow on your webpage. Also when using the widget you must pass the <strong>email of the signer</strong> (name is optional) so that we can send them a copy of the signed document when the signing process is complete.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/documents</code></p>
<h3 id='parameters'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td>File to be signed (The hash will be automatically extracted from the file and signed)</td>
</tr>
<tr>
<td>original_hash</td>
<td>String</td>
<td><strong>Optional</strong> <em>SHA256 encoded</em> Hash of the original, unsigned document (The hash will be signed)</td>
</tr>
<tr>
<td>signatories</td>
<td>Array[Signatory]</td>
<td>A list of <a href="#signatory">Signatory Object</a></td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
<tr>
<td>external_id</td>
<td>String</td>
<td><strong>Optional</strong> A unique id for you to identify the document in the response or fetch it</td>
</tr>
<tr>
<td>track</td>
<td>Boolean</td>
<td><strong>Optional</strong> true if you want your document to be andorsable.</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td><strong>Optional</strong> (Required if param track is true) For now, the only value is &#39;promissory-note&#39; (pagaré)</td>
</tr>
</tbody></table>

<aside class="info">
  <ul style="margin: 0; padding: 0">
    <li>The <b>file</b> must be passed.</li>
    <li>The <b>email</b> in the <b>signatories</b> param is <b>required</b> when using embedded signing.</li>
  </ul>
</aside>

<aside class="info">
  If you want the generated documents to be endorsables you must pass the attribute <b>track: true</b> and the type of endorsable <b>type: 'promissory-note'</b>. Right now we only have <i>promissory-note</i> but we plan to add more in the future.
</aside>
<h3 id='response'>Response</h3>
<p>Returns a <a href="#document">Document Model</a></p>
<h2 id='get-a-specific-document'>Get a Specific Document</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="nf">original_hash</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file_signed</span>
<span class="n">document</span><span class="p">.</span><span class="nf">widget_id</span>
<span class="c1"># ...</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">original_hash</span><span class="p">;</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">;</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">file_signed</span><span class="p">;</span>
<span class="c1"># ...</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'id'</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">original_hash</span>
<span class="n">document</span><span class="o">.</span><span class="nb">file</span>
<span class="n">document</span><span class="o">.</span><span class="n">file_signed</span>
<span class="c1"># ...
</span></code></pre></div>
<p>Allows you to retrieve a specific document.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/documents/:id</code></p>
<h3 id='response-2'>Response</h3>
<p>Returns a <a href="#document">Document Models</a></p>
<h2 id='get-all-documents'>Get All Documents</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">documents</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">all</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/documents"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$documents</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">documents</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</code></pre></div>
<p>Allows you to retrieve all documents in your account.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/documents</code></p>
<h3 id='response-3'>Response</h3>
<p>Returns an Array of <a href="#document">Document Model</a></p>
<h2 id='delete-a-document'>Delete a Document</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> DELETE <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nx">Document</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">Document</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div>
<p>Allows you to delete a specific document in your account.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>DELETE https://www.mifiel.com/api/v1/documents/:id</code></p>
<h2 id='request-signature'>Request signature</h2>
<p>Sends an email request for the document to be signed.</p>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">email</span> <span class="o">=</span> <span class="s1">'signer@email.com'</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'signer@email.com'</span><span class="p">,</span> <span class="s1">'viewer@email.com'</span><span class="p">]</span>
<span class="n">document</span><span class="p">.</span><span class="nf">request_signature</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="ss">cc: </span><span class="n">cc</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678/request_signature"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">email</span> <span class="o">=</span> <span class="s">'signer@email.com'</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="s">'signer@email.com'</span><span class="p">,</span> <span class="s">'viewer@email.com'</span><span class="p">]</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">request_signature</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">cc</span><span class="o">=</span><span class="n">cc</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Correo enviado"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="w">        
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='http-request-5'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/documents/:id/request_signature</code></p>
<h3 id='parameters-2'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>cc</td>
<td>String</td>
<td>Email of any non-signing viewers that should receive a copy of the signed document</td>
</tr>
</tbody></table>
<h2 id='transfer-a-document'>Transfer a document</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>

<span class="c1"># For promissory-note the call is very simple</span>
<span class="n">document</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="ss">receiver: </span><span class="s1">'receiver@email.com'</span><span class="p">,</span> <span class="c1"># simple</span>
  <span class="ss">receiver: </span><span class="p">{</span> <span class="c1"># if you want to ensure that the receiver has a specific tax_id (RFC)</span>
    <span class="ss">name: </span><span class="s1">'Receiver'</span><span class="p">,</span>
    <span class="ss">email: </span><span class="s1">'receiver@email.com'</span><span class="p">,</span>
    <span class="ss">tax_id: </span><span class="s1">'AAA010102AAA'</span>
  <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Or for a specific endorsable document type</span>
<span class="n">document</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span>
  <span class="ss">file: </span><span class="s1">'path/to/my-transfer-file.pdf'</span><span class="p">,</span> <span class="c1"># required in certain endorsable document types</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="ss">signatories: </span><span class="p">[{</span>
    <span class="ss">name: </span><span class="s1">'Issuer'</span><span class="p">,</span>
    <span class="ss">email: </span><span class="s1">'issuer@email.com'</span><span class="p">,</span>
    <span class="ss">tax_id: </span><span class="s1">'AAA010101AAA'</span><span class="p">,</span>
    <span class="ss">field: </span><span class="s1">'issuer'</span> <span class="c1"># Could change depending on the endorsable document type</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="ss">name: </span><span class="s1">'Receiver'</span><span class="p">,</span>
    <span class="ss">email: </span><span class="s1">'receiver@email.com'</span><span class="p">,</span>
    <span class="ss">tax_id: </span><span class="s1">'AAA010102AAA'</span><span class="p">,</span>
    <span class="ss">field: </span><span class="s1">'receiver'</span> <span class="c1"># Could change depending on the endorsable document type</span>
  <span class="p">}]</span>
<span class="p">)</span>

<span class="c1"># Transfer using a template</span>
<span class="n">document</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span>
  <span class="o">...</span>
  <span class="ss">template_id: </span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="ss">fields: </span><span class="p">{</span>
    <span class="ss">name: </span><span class="s1">'My Client Name'</span><span class="p">,</span>
    <span class="ss">date: </span><span class="s1">'27 Sep 2017'</span>
  <span class="p">}</span>
  <span class="o">...</span>
<span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678/transfer <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"file=@my-file.pdf"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][name]=Issuer"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][email]=issuer@email.com"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][field]=issuer"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[1][name]=Receiver"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[1][email]=receiver@email.com"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[1][field]=receiver"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"callback_url=https://www.example.com/webhook/url"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="c1"># For promissory-note the call is very simple</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">transfer</span><span class="p">([</span>
  <span class="s1">'callback_url'</span><span class="o">:</span> <span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s1">'receiver'</span><span class="o">:</span> <span class="s1">'receiver@email.com'</span><span class="p">,</span> <span class="c1"># simple</span>
  <span class="s1">'receiver'</span><span class="o">:</span> <span class="p">[</span> <span class="c1"># if you want to ensure that the receiver has a specific tax_id (RFC)</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'Receiver'</span><span class="p">,</span>
    <span class="s1">'email'</span><span class="o">:</span> <span class="s1">'receiver@email.com'</span><span class="p">,</span>
    <span class="s1">'tax_id'</span><span class="o">:</span> <span class="s1">'AAA010102AAA'</span>
  <span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Or for a specific endorsable document type</span>
<span class="nv">$document</span><span class="o">.</span><span class="nx">transfer</span><span class="p">(</span>
  <span class="s1">'file'</span><span class="o">:</span> <span class="s1">'path/to/my-transfer-file.pdf'</span><span class="p">,</span> <span class="c1"># required in certain endorsable document types</span>
  <span class="s1">'callback_url'</span><span class="o">:</span> <span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s1">'signatories'</span><span class="o">:</span> <span class="p">[[</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'Issuer'</span><span class="p">,</span>
    <span class="s1">'email'</span><span class="o">:</span> <span class="s1">'issuer@email.com'</span><span class="p">,</span>
    <span class="s1">'tax_id'</span><span class="o">:</span> <span class="s1">'AAA010101AAA'</span><span class="p">,</span>
    <span class="s1">'field'</span><span class="o">:</span> <span class="s1">'issuer'</span> <span class="c1"># Could change depending on the endorsable document type</span>
  <span class="p">],</span> <span class="p">[</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'Receiver'</span><span class="p">,</span>
    <span class="s1">'email'</span><span class="o">:</span> <span class="s1">'receiver@email.com'</span><span class="p">,</span>
    <span class="s1">'tax_id'</span><span class="o">:</span> <span class="s1">'AAA010102AAA'</span><span class="p">,</span>
    <span class="s1">'field'</span><span class="o">:</span> <span class="s1">'receiver'</span> <span class="c1"># Could change depending on the endorsable document type</span>
  <span class="p">]]</span>
<span class="p">)</span>

<span class="c1"># Transfer using a template</span>
<span class="nv">$document</span><span class="o">.</span><span class="nx">transfer</span><span class="p">([</span>
  <span class="c1"># ...</span>
  <span class="s1">'template_id'</span><span class="o">:</span> <span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s1">'fields'</span><span class="o">:</span> <span class="p">[</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'My Client Name'</span><span class="p">,</span>
    <span class="s1">'date'</span><span class="o">:</span> <span class="s1">'27 Sep 2017'</span>
  <span class="p">]</span>
  <span class="c1"># ...</span>
<span class="p">])</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="c1"># For promissory-note the call is very simple
</span><span class="n">document</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
  <span class="s">'callback_url'</span><span class="p">:</span> <span class="s">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s">'receiver'</span><span class="p">:</span> <span class="s">'receiver@email.com'</span><span class="p">,</span> <span class="c1"># simple
</span>  <span class="s">'receiver'</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># if you want to ensure that the receiver has a specific tax_id (RFC)
</span>    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Receiver'</span><span class="p">,</span>
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'receiver@email.com'</span><span class="p">,</span>
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010102AAA'</span>
  <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Or for a specific endorsable document type
</span><span class="n">document</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
  <span class="s">'file'</span><span class="p">:</span> <span class="s">'path/to/my-transfer-file.pdf'</span><span class="p">,</span> <span class="c1"># required in certain endorsable document types
</span>  <span class="s">'callback_url'</span><span class="p">:</span> <span class="s">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s">'signatories'</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Issuer'</span><span class="p">,</span>
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'issuer@email.com'</span><span class="p">,</span>
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010101AAA'</span><span class="p">,</span>
    <span class="s">'field'</span><span class="p">:</span> <span class="s">'issuer'</span> <span class="c1"># Could change depending on the endorsable document type
</span>  <span class="p">},</span> <span class="p">{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Receiver'</span><span class="p">,</span>
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'receiver@email.com'</span><span class="p">,</span>
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010102AAA'</span><span class="p">,</span>
    <span class="s">'field'</span><span class="p">:</span> <span class="s">'receiver'</span> <span class="c1"># Could change depending on the endorsable document type
</span>  <span class="p">}]</span>
<span class="p">)</span>

<span class="c1"># Transfer using a template
</span><span class="n">document</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
  <span class="c1"># ...
</span>  <span class="s">'template_id'</span><span class="p">:</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s">'fields'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'My Client Name'</span><span class="p">,</span>
    <span class="s">'date'</span><span class="p">:</span> <span class="s">'27 Sep 2017'</span>
  <span class="p">}</span>
  <span class="c1"># ...
</span><span class="p">)</span>
</code></pre></div>
<p>Endorsable documents (created with <code>track: true</code> param) can be transferred to other users. To do this, the receiver must have an account in <a href="www.mifiel.com">Mifiel</a> and must have set up their account to be able to receive endorsable documents.</p>

<p>A transfer document is a page that is annexed to the original document that contains the terms of the agreement to endorse the document. It is signed by the owner (as well as the receiver in some cases) to acknowledge that the ownership of the document has been transferred. Mifiel generates a transfer document by default at the time of endorsement, but if you would like to use your own custom text and design, please contact us.</p>

<p>In the case that the receiver account is not configured, we will return an error and send an email requiring him to do so. When the receiver configures his account we will send a notification to the callback_url provided so your system knows when to retry the call again.</p>

<p>Use this endpoint to transfer an endorsable document.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/documents/:id/transfer</code></p>
<h3 id='parameters-3'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
<tr>
<td>receiver</td>
<td>String(email) OR Hash</td>
<td><strong>Optional</strong> Receiver info, it could be an email or a hash containing <strong>name</strong>, <strong>tax_id</strong> (RFC) and <strong>email</strong>.</td>
</tr>
<tr>
<td>file</td>
<td>File</td>
<td><strong>Optional</strong> The Transfer File. Depending on the endorsable document type, it could be required.</td>
</tr>
<tr>
<td>signatories</td>
<td>Array[Signatory]</td>
<td><strong>Optional</strong> A list of <a href="#signatory">Signatory Object</a></td>
</tr>
<tr>
<td>template_id</td>
<td>String</td>
<td><strong>Optional</strong> The template id that you want to use to create the File.</td>
</tr>
<tr>
<td>fields</td>
<td>JSON [Hash]</td>
<td><strong>Optional</strong> A hash with the fields <code>{name: value}</code></td>
</tr>
</tbody></table>
<h3 id='response-4'>Response</h3>
<p>Returns a <a href="#tracked-document">Tracked Document Model</a></p>
<h1 id='certificates'>Certificates</h1>
<p>At the moment we only support signing with the FIEL (the most frequently used advanced electronic signature in Mexico). We will  soon be adding support for additional types of electronic signatures and will update the documentation as we do so.</p>
<h2 id='create-a-certificate'>Create a Certificate</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">file: </span><span class="s1">'path/to/my-certificate.cer'</span>
<span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST https://www.mifiel.com/api/v1/keys <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"file=@my-certificate.cer"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Certificate</span><span class="p">([</span>
  <span class="s1">'file'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/my-certificate.cer'</span>
<span class="p">])</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>Uploads the certificate of a signer in your account.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/keys</code></p>
<h3 id='parameters'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td><code>.cer</code> File of your FIEL</td>
</tr>
</tbody></table>

<aside class="info">
  You only have to send the public certificate of the signer. We will never store the private key in our servers.
</aside>
<h3 id='response'>Response</h3>
<p>Returns a <a href="#certificate">Certificate Model</a></p>
<h2 id='get-a-specific-certificate'>Get a Specific Certificate</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">type_of</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">owner</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">tax_id</span>
<span class="c1"># ...</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificate</span> <span class="o">=</span> <span class="nx">Certificate</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">);</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">cer_hex</span><span class="p">;</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">type_of</span><span class="p">;</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">owner</span><span class="p">;</span>
<span class="c1"># ...</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>Allows you to retrieve a specific certificate.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/keys/:id</code></p>
<h3 id='response-2'>Response</h3>
<p>Returns a <a href="#certificate">Certificate Model</a></p>
<h2 id='get-all-certificates'>Get All Certificates</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificates</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">all</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/keys"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificates</span> <span class="o">=</span> <span class="nx">Certificate</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>Allows you to retrieve ALL certificates in your account.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/keys</code></p>
<h3 id='response-3'>Response</h3>
<p>Returns an Array of a <a href="#certificate">Certificate Model</a></p>
<h2 id='delete-a-certificate'>Delete a Certificate</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> DELETE <span class="s2">"https://www.mifiel.com/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Certificate</span><span class="p">;</span>

<span class="nx">Certificate</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>Allows you to delete a specific certificate in your account.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>DELETE https://www.mifiel.com/api/v1/keys/:id</code></p>
<h1 id='templates'>Templates</h1><h2 id='create-a-template'>Create a Template</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">content</span> <span class="o">=</span> <span class="s1">'&lt;div&gt;'</span> <span class="p">\</span>
            <span class="s1">'Name &lt;field name="name" type="text"&gt;NAME&lt;/field&gt;'</span> <span class="p">\</span>
            <span class="s1">'Date &lt;field name="date" type="text"&gt;DATE&lt;/field&gt;'</span> <span class="p">\</span>
          <span class="s1">'&lt;/div&gt;'</span>

<span class="n">template</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">name: </span><span class="s1">'my-company-nda'</span><span class="p">,</span> 
  <span class="ss">description: </span><span class="s1">'Confidential disclosure agreement'</span><span class="p">,</span>
  <span class="ss">header: </span><span class="s1">'&lt;div&gt;some header html&lt;/div&gt;'</span><span class="p">,</span> 
  <span class="ss">content: </span><span class="n">content</span><span class="p">,</span> 
  <span class="ss">footer: </span><span class="s1">'&lt;div&gt;some footer html&lt;/div&gt;'</span>
<span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST https://www.mifiel.com/api/v1/templates <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"name=my-company-nda"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"description=Confidential disclosure agreement"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"content=&lt;div&gt;html content&lt;/div&gt;"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Template</span><span class="p">;</span>

<span class="nv">$content</span> <span class="o">=</span> <span class="s1">'&lt;div&gt;'</span> <span class="o">.</span>
             <span class="s1">'Name &lt;field name="name" type="text"&gt;NAME&lt;/field&gt;'</span> <span class="o">.</span>
             <span class="s1">'Date &lt;field name="date" type="text"&gt;DATE&lt;/field&gt;'</span> <span class="o">.</span>
           <span class="s1">'&lt;/div&gt;'</span>

<span class="nv">$template</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Template</span><span class="p">([</span>
  <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'my-company-nda'</span><span class="p">,</span> 
  <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Confidential disclosure agreement'</span><span class="p">,</span>
  <span class="s1">'header'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div&gt;some header html&lt;/div&gt;'</span><span class="p">,</span> 
  <span class="s1">'content'</span> <span class="o">=&gt;</span> <span class="nv">$content</span><span class="p">,</span> 
  <span class="s1">'footer'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;div&gt;some footer html&lt;/div&gt;'</span>
<span class="p">]);</span>
<span class="nv">$template</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">content</span> <span class="o">=</span> <span class="s">'&lt;div&gt;'</span> <span class="o">+</span>
             <span class="s">'Name &lt;field name="name" type="text"&gt;NAME&lt;/field&gt;'</span> <span class="o">+</span>
             <span class="s">'Date &lt;field name="date" type="text"&gt;DATE&lt;/field&gt;'</span> <span class="o">+</span>
           <span class="s">'&lt;/div&gt;'</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span>
  <span class="n">name</span><span class="o">=</span><span class="s">'my-company-nda'</span><span class="p">,</span> 
  <span class="n">description</span><span class="o">=</span><span class="s">'Confidential disclosure agreement'</span><span class="p">,</span>
  <span class="n">header</span><span class="o">=</span><span class="s">'&lt;div&gt;some header html&lt;/div&gt;'</span><span class="p">,</span> 
  <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> 
  <span class="n">footer</span><span class="o">=</span><span class="s">'&lt;div&gt;some footer html&lt;/div&gt;'</span>
<span class="p">)</span>
</code></pre></div>
<p>Templates are a tool that allows you to create templates that have a base format. You can define fields within the html so you can then create a custumized document.</p>

<aside class="info">
  If you want the documents generated from the template to be endorsable, you must pass the attribute <b>track: true</b> and specify the type of endorsable document you'd like it to be. At the moment the only type available is promissory notes (pagarés), which you can specify by passing the attribute <b>type: 'promissory-note'</b>.
</aside>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/templates</code></p>
<h3 id='parameters'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>track</td>
<td>Boolean</td>
<td><strong>Optional</strong> true if you want documents generated from this template to be endorsable</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td><strong>Optional</strong> (Required if param track is true) For now, the only value is &#39;promissory-note&#39; (pagaré)</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>The name of the template</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td><strong>Optional</strong> Internal description of your template</td>
</tr>
<tr>
<td>header</td>
<td>Text/HTML</td>
<td><strong>Optional</strong> The Header of the PDF</td>
</tr>
<tr>
<td>content</td>
<td>Text/HTML</td>
<td>The Content of the PDF</td>
</tr>
<tr>
<td>footer</td>
<td>Text/HTML</td>
<td><strong>Optional</strong> The footer of the PDF</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<p>Returns a <a href="#template">Template Model</a></p>
<h2 id='get-a-specific-template'>Get a Specific Template</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">template</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">template</span><span class="p">.</span><span class="nf">name</span>
<span class="n">template</span><span class="p">.</span><span class="nf">header</span>
<span class="n">template</span><span class="p">.</span><span class="nf">content</span>
<span class="c1"># ...</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/templates/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Template</span><span class="p">;</span>

<span class="nv">$template</span> <span class="o">=</span> <span class="nx">Template</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="nv">$template</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
<span class="nv">$template</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">;</span>
<span class="nv">$template</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">;</span>
<span class="c1"># ...</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'id'</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">name</span>
<span class="n">template</span><span class="o">.</span><span class="n">header</span>
<span class="n">template</span><span class="o">.</span><span class="n">content</span>
<span class="c1"># ...
</span></code></pre></div>
<p>Allows you to retrieve a specific template.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/templates/:id</code></p>
<h3 id='response-2'>Response</h3>
<p>Returns a <a href="#template">Template Model</a></p>
<h2 id='get-all-templates'>Get All Templates</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">templates</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">all</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/templates"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Template</span><span class="p">;</span>

<span class="nv">$templates</span> <span class="o">=</span> <span class="nx">Template</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">templates</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</code></pre></div>
<p>Allows you to retrieve all templates in your account.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/templates</code></p>
<h3 id='response-3'>Response</h3>
<p>Returns an Array of <a href="#template">Template Models</a></p>
<h2 id='delete-a-template'>Delete a Template</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> DELETE <span class="s2">"https://www.mifiel.com/api/v1/templates/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Template</span><span class="p">;</span>

<span class="nx">Template</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">Template</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div>
<p>Allows you to delete a specific template in your account.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>DELETE https://www.mifiel.com/api/v1/templates/:id</code></p>
<h2 id='template-fields'>Template fields</h2>
<p>Get the fields of a specific template. Use it to know what to send to generate documents with this template.</p>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">fields</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">fields</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/templates/29f3cb01-744d-4eae-8718-213aec8a1678/fields"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Template</span><span class="p">;</span>

<span class="nx">Template</span><span class="o">::</span><span class="na">fields</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">fields</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="n">fields</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[{</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Miguel Rodriguez"</span><span class="w"> 
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w"> 
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15/8/2018"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></code></pre></div><h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/templates/:id/fields</code></p>
<h3 id='response-4'>Response</h3>
<p>Returns an array of the template fields (parsed from the HTML) where each field has the following information:</p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>HTML type attribute of the field</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>HTML name attribute of the field</td>
</tr>
<tr>
<td>value</td>
<td>String</td>
<td>Value which was placed between the field tag in the HTML</td>
</tr>
</tbody></table>
<h2 id='template-documents'>Template documents</h2>
<p>Get all the active (non deleted) documents generated from a specific template.</p>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">documents</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Template</span><span class="p">.</span><span class="nf">documents</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">documents</span><span class="p">.</span><span class="nf">first</span>
<span class="c1"># Mifiel::Document</span>
<span class="n">document</span><span class="p">.</span><span class="nf">id</span>
<span class="c1"># "abcd1234"</span>
<span class="n">document</span><span class="p">.</span><span class="nf">status</span>
<span class="c1"># [0, "Pending"]</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/templates/29f3cb01-744d-4eae-8718-213aec8a1678/documents"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Template</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">documents</span> <span class="o">=</span> <span class="n">Template</span><span class="o">.</span><span class="n">documents</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"document-id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file-name.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"Pending"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></code></pre></div><h3 id='http-request-6'>HTTP Request</h3>
<p><code>GET https://www.mifiel.com/api/v1/templates/:id/documents</code></p>
<h3 id='response-5'>Response</h3>
<p>Returns an array with the following information about each document: </p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>ID of the document</td>
</tr>
<tr>
<td>file_name</td>
<td>String</td>
<td>Name of the template file created</td>
</tr>
<tr>
<td>status</td>
<td>Array</td>
<td>[code, code_message] <code>0: not signed, 1: signed</code></td>
</tr>
<tr>
<td>owner</td>
<td>Object</td>
<td>The owner of the document. The user who created the document.</td>
</tr>
<tr>
<td>file</td>
<td>String</td>
<td>Path where the original document can be downloaded</td>
</tr>
</tbody></table>
<h2 id='generate-a-document-from-a-template'>Generate a document from a template</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create_from_template</span><span class="p">(</span>
  <span class="ss">template_id: </span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span> 
  <span class="ss">name: </span><span class="s1">'document.pdf'</span><span class="p">,</span>
  <span class="ss">fields: </span><span class="p">{</span>
    <span class="ss">name: </span><span class="s1">'My Client Name'</span><span class="p">,</span>
    <span class="ss">date: </span><span class="s1">'Sep 27 2017'</span>
  <span class="p">},</span>
  <span class="ss">signatories: </span><span class="p">[{</span>
    <span class="ss">name: </span><span class="s1">'Some name'</span><span class="p">,</span>
    <span class="ss">email: </span><span class="s1">'some@email.com'</span><span class="p">,</span>
    <span class="ss">tax_id: </span><span class="s1">'AAA010101AAA'</span>
  <span class="p">}],</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="ss">external_id: </span><span class="s1">'unique-id'</span>
<span class="p">)</span>

<span class="c1"># If you already have a Template instance you can also do</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">template</span><span class="p">.</span><span class="nf">generate_document</span><span class="p">(</span>
  <span class="ss">name: </span><span class="s1">'document.pdf'</span><span class="p">,</span>
  <span class="ss">fields: </span><span class="p">{</span> <span class="o">...</span> <span class="p">},</span>
  <span class="o">...</span>
<span class="p">)</span>

<span class="c1"># document.id</span>
<span class="c1"># document.original_hash</span>
<span class="c1"># document.signers</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span> POST <span class="s2">"https://www.mifiel.com/api/v1/templates/29f3cb01-744d-4eae-8718-213aec8a1678/generate_document"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"namme='My Client Name'"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"fields[name]=My Client Name"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"fields[date]=Sep 27 2017"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][name]=Some name"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][email]=some@email.com"</span> <span class="se">\</span>
  <span class="nt">-F</span> <span class="s2">"signatories[0][tax_id]=AAA010101AAA"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'template_id'</span><span class="p">:</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s">'name'</span><span class="p">:</span> <span class="s">'My NDA'</span><span class="p">,</span>
  <span class="s">'fields'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'My Client Name'</span><span class="p">,</span>
    <span class="s">'date'</span><span class="p">:</span> <span class="s">'Sep 27 2017'</span>
  <span class="p">},</span>
  <span class="s">'signatories'</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Some name'</span><span class="p">,</span>
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'some@email.com'</span><span class="p">,</span>
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010101AAA'</span>
  <span class="p">}],</span>
  <span class="s">'callback_url'</span><span class="p">:</span> <span class="s">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s">'external_id'</span><span class="p">:</span> <span class="s">'unique-id'</span>
<span class="p">}</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create_from_template</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$args</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'template_id'</span> <span class="o">=&gt;</span> <span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'My NDA'</span><span class="p">,</span>
  <span class="s1">'fields'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'My Client Name'</span><span class="p">,</span>
    <span class="s1">'date'</span> <span class="o">=&gt;</span> <span class="s1">'Sep 27 2017'</span>
  <span class="p">],</span>
  <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="p">[[</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Some name'</span><span class="p">,</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'some@email.com'</span><span class="p">,</span>
    <span class="s1">'tax_id'</span> <span class="o">=&gt;</span> <span class="s1">'AAA010101AAA'</span>
  <span class="p">]],</span>
  <span class="s1">'callback_url'</span> <span class="o">=&gt;</span> <span class="s1">'https://www.example.com/webhook/url'</span><span class="p">,</span>
  <span class="s1">'external_id'</span> <span class="o">=&gt;</span> <span class="s1">'unique-id'</span>
<span class="p">]</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">.</span><span class="nx">create_document</span><span class="p">(</span><span class="nv">$args</span><span class="p">)</span>
<span class="cp">?&gt;</span>
</code></pre></div><h3 id='http-request-7'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/templates/:id/generate_document</code></p>
<h3 id='parameters-2'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>track</td>
<td>Boolean</td>
<td><strong>Optional</strong> true if you want your document to be endorsable</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td><strong>Optional</strong> (Required if param track is true) For now, the only value is &#39;promissory-note&#39; (pagaré)</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td><strong>Optional</strong> The name of the document</td>
</tr>
<tr>
<td>fields</td>
<td>JSON [Hash]</td>
<td>A hash with the fields <code>{name: value}</code></td>
</tr>
<tr>
<td>signatories</td>
<td>Array[Signatory]</td>
<td>A list of <a href="#signatory">Signatory Object</a></td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
<tr>
<td>external_id</td>
<td>String</td>
<td><strong>Optional</strong> A unique id for you to identify the document in the response or fetch it</td>
</tr>
</tbody></table>
<h3 id='response-6'>Response</h3>
<p>Returns a <a href="#document">Document Model</a></p>
<h2 id='generate-several-documents-from-a-template'>Generate several documents from a template</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">template_id: </span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="ss">identifier: </span><span class="s1">'name'</span><span class="p">,</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.my-site.com/documents-ready'</span><span class="p">,</span>
  <span class="ss">documents: </span><span class="p">[{</span>
    <span class="ss">fields: </span><span class="p">{</span>
      <span class="ss">name: </span><span class="s1">'My Client Name'</span><span class="p">,</span>
      <span class="ss">date: </span><span class="s1">'Sep 27 2017'</span>
    <span class="p">},</span>
    <span class="ss">signatories: </span><span class="p">[{</span>
      <span class="ss">name: </span><span class="s1">'Some Name'</span><span class="p">,</span>
      <span class="ss">email: </span><span class="s1">'some@email.com'</span><span class="p">,</span>
      <span class="ss">tax_id: </span><span class="s1">'AAA010101AAA'</span>
    <span class="p">}],</span>
    <span class="ss">callback_url: </span><span class="s1">'https://www.my-site.com/sign-webhook'</span><span class="p">,</span>
    <span class="ss">external_id: </span><span class="s1">'unique-id'</span>
  <span class="p">}]</span>
<span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create_many_from_template</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="n">response</span><span class="p">.</span><span class="nf">status</span> <span class="o">==</span> <span class="s1">'success'</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'template_id'</span><span class="p">:</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s">'identifier'</span><span class="p">:</span> <span class="s">'name'</span><span class="p">,</span>
  <span class="s">'callback_url'</span><span class="p">:</span> <span class="s">'https://www.my-site.com/documents-ready'</span><span class="p">,</span>
  <span class="s">'documents'</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s">'fields'</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">'name'</span><span class="p">:</span> <span class="s">'My Client Name'</span><span class="p">,</span>
      <span class="s">'date'</span><span class="p">:</span> <span class="s">'Sep 27 2017'</span>
    <span class="p">},</span>
    <span class="s">'signatories'</span><span class="p">:</span> <span class="p">[{</span>
      <span class="s">'name'</span><span class="p">:</span> <span class="s">'Some Name'</span><span class="p">,</span>
      <span class="s">'email'</span><span class="p">:</span> <span class="s">'some@email.com'</span><span class="p">,</span>
      <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010101AAA'</span>
    <span class="p">}],</span>
    <span class="s">'callback_url'</span><span class="p">:</span> <span class="s">'https://www.my-site.com/sign-webhook'</span><span class="p">,</span>
    <span class="s">'external_id'</span><span class="p">:</span> <span class="s">'unique-id'</span>
  <span class="p">}]</span>
<span class="p">}</span>
<span class="n">documents</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create_many_from_template</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">template_id</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">docs</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$args</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'template_id'</span> <span class="o">=&gt;</span> <span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">,</span>
  <span class="s1">'identifier'</span> <span class="o">=&gt;</span> <span class="s1">'name'</span><span class="p">,</span>
  <span class="s1">'callback_url'</span> <span class="o">=&gt;</span> <span class="s1">'https://www.my-site.com/documents-ready'</span><span class="p">,</span>
  <span class="s1">'documents'</span> <span class="o">=&gt;</span> <span class="p">[{</span>
    <span class="s1">'fields'</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'My Client Name'</span><span class="p">,</span>
      <span class="s1">'date'</span> <span class="o">=&gt;</span> <span class="s1">'Sep 27 2017'</span>
    <span class="p">},</span>
    <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="p">[{</span>
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Some Name'</span><span class="p">,</span>
      <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'some@email.com'</span><span class="p">,</span>
      <span class="s1">'tax_id'</span> <span class="o">=&gt;</span> <span class="s1">'AAA010101AAA'</span>
    <span class="p">}],</span>
    <span class="s1">'callback_url'</span> <span class="o">=&gt;</span> <span class="s1">'https://www.my-site.com/sign-webhook'</span><span class="p">,</span>
    <span class="s1">'external_id'</span> <span class="o">=&gt;</span> <span class="s1">'unique-id'</span>
  <span class="p">}]</span>
<span class="p">]</span>
<span class="nv">$documents</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">.</span><span class="nx">create_many_from_template</span><span class="p">(</span><span class="nv">$args</span><span class="p">)</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<p>The generation of documents runs in the background. We will respond with 200 (OK) and start generating the documents. When our servers finish, we will POST you to the provided <code>callback_url</code> with a list of the created documents.</p>
<h3 id='http-request-8'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/templates/:id/generate_documents</code></p>

<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>When the documents are ready, we will send you a POST to the <strong>callback_url</strong> with the following params:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d6793b57-9101-4ce3-ae0d-e51868f3fdf9"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"folio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{asset_id}|{address}"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"signers"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Some Name"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"widget_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d6793b57-9101-4ce3-ae0d-e51868f3fdf9"</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nl">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NDA-My-Client-Name.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.my-site.com/webhook"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unique-id"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></code></pre></div><h3 id='parameters-3'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>String</td>
<td><strong>Optional</strong> A field name to use in the document name e.g &quot;name&quot; will append the field &quot;name&quot; to the document name &quot;My-NDA-My-Client-Name.pdf&quot;</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>A Callback URL to POST when all documents have been created</td>
</tr>
<tr>
<td>documents</td>
<td>Array[Document]</td>
<td>Array of documents to create</td>
</tr>
</tbody></table>
<h3 id='documents-param'>Documents Param</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Hash</td>
<td>The name of the document eg. <em>document.pdf</em></td>
</tr>
<tr>
<td>fields</td>
<td>Hash</td>
<td>Hash of key, value of each field <br><code>{field_name: &#39;Field Content&#39;}</code></td>
</tr>
<tr>
<td>signatories</td>
<td>Array[Signatory]</td>
<td>A list of <a href="#signatory">Signatory Object</a></td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
<tr>
<td>external_id</td>
<td>String</td>
<td><strong>Optional</strong> A unique id for you to identify the document in the response or fetch it</td>
</tr>
</tbody></table>
<h1 id='embedded-signing'>Embedded Signing</h1><h2 id='widget'>Widget</h2>
<blockquote>
<p>Copy this code and paste it just before the <b>&lt;/body&gt;</b> tag.</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">||</span><span class="p">[],</span><span class="kd">function</span><span class="p">(){</span><span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">[</span><span class="dl">"</span><span class="s2">widget</span><span class="dl">"</span><span class="p">],</span><span class="nx">i</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">e</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)))}},</span><span class="nx">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">t</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">t</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">t</span><span class="p">];</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">n</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">mifiel-js</span><span class="dl">"</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">script</span><span class="dl">"</span><span class="p">),</span><span class="nx">o</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">"</span><span class="s2">script</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text/javascript</span><span class="dl">"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">mifiel-js</span><span class="dl">"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="k">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://www.mifiel.com/sign-widget-v1.0.0.js</span><span class="dl">"</span><span class="p">,</span><span class="nx">o</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">o</span><span class="p">)}}();</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<blockquote>
<p>Then insert the widget in the desired view (page) by including the following snippet:</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">widget</span><span class="p">({</span>
    <span class="na">widgetId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">c8aa73d1-db06-4d18-9f56-196b00f6eb69</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">appendTo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">id-of-the-element-to-append</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">successBtnText</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Proceed to next step</span><span class="dl">'</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>The widget is an embedded signing tool that we have created to allow your users to sign documents in an iFrame within your page. By embedding this tool, your users can sign seamlessly without having to leave the flow of your website.</p>

<p><em>Note: The signers do not have to have an account in <a href="https://www.mifiel.com">mifiel.com</a></em></p>

<p>To begin, you have to copy and paste our code snippet (<em>shown to your right</em>) into the code of the page where the signing flow will take place.</p>

<p>You can also find the code snippet <a href="https://www.mifiel.com/sign-snippet-v1.0.0.min.js">here</a>.</p>
<h3 id='options'>Options</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>widgetId</td>
<td>String</td>
<td></td>
<td>Widget ID. You can get it with <code>document.widget_id</code> in Ruby</td>
</tr>
<tr>
<td>appendTo</td>
<td>String</td>
<td>body</td>
<td>ID of the element in the page</td>
</tr>
<tr>
<td>successBtnText</td>
<td>String</td>
<td>&#39;OK&#39;</td>
<td>Text of the button at the end of the signing flow. When the user click</td>
</tr>
<tr>
<td>pdf</td>
<td>Base64</td>
<td>null</td>
<td><strong>Optional</strong> PDF in Base64 if you did not send us the PDF when you created the document.</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>37BC9B</td>
<td><strong>Optional</strong> Custom color in hexadecimal (e.g. 555555) to personalize the look and feel of your widget. Typically the primary color of your app.</td>
</tr>
<tr>
<td>width</td>
<td>String</td>
<td>100%</td>
<td><strong>Optional</strong> Width of the widget <strong>[px or %]</strong></td>
</tr>
<tr>
<td>height</td>
<td>String</td>
<td>1100</td>
<td><strong>Optional</strong> Height of the widget <strong>[px]</strong></td>
</tr>
</tbody></table>
<h2 id='events'>Events</h2>
<blockquote>
<p>Listen for Mifiel events:</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="c1">// accept messages from known hosts only</span>
  <span class="c1">// change to https://stageex.mifiel.com if necessary</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">origin</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">https://www.mifiel.com</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// We will always send an object</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// document signed succesfully</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">mifiel.widget.success</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
        <span class="nx">doc</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
        <span class="nx">signature</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">signature</span><span class="p">;</span>
    <span class="c1">// doc.original_hash;</span>
    <span class="c1">// doc.file_signed;</span>
  <span class="p">}</span>
  <span class="c1">// Event errors</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">mifiel.widget.error</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
    <span class="c1">// error.code =&gt; 1001</span>
    <span class="c1">// error.message =&gt; 'Invalid PDF, the pdf param has no data'</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>We will send a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a> to your page to notify any of the events listed below.</p>

<p>In order to secure the events sent by the widget you <strong>must</strong> verify that the event is coming from our servers. </p>

<p>You can identify the events by <em>e.data.eventType</em>. The success event will have <strong>&quot;mifiel.widget.success&quot;</strong> and the error events will have <strong>&quot;mifiel.widget.error&quot;</strong>.</p>
<h3 id='success-event'>Success event</h3>
<p>We will send the document json object and the signature of the user.</p>
<h3 id='error-events'>Error events</h3>
<p>Error events have the property <em>eventType</em> set as <strong>&quot;mifiel.widget.error&quot;</strong> and a error object <em>(e.data.error)</em> with <em>code</em> and <em>message</em> properties:</p>
<h4 id='widget-setup-error-events'>Widget setup error events</h4>
<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Empty PDF</td>
<td>1001</td>
<td>Invalid PDF, the pdf param has no data</td>
</tr>
<tr>
<td>Hashes do not match</td>
<td>1002</td>
<td>Invalid PDF, the provided pdf param is not the same as the uploaded one</td>
</tr>
</tbody></table>

<p><em>Note: We send this errors only when you did not send us the PDF when the document was created.</em></p>
<h4 id='user-error-events'>User error events</h4>
<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Invalid Certificate</td>
<td>2001</td>
<td>Certificate is not valid</td>
</tr>
<tr>
<td>Invalid Private Key</td>
<td>2002</td>
<td>Invalid Private Key</td>
</tr>
<tr>
<td>Invalid Pasword</td>
<td>2003</td>
<td>Invalid password</td>
</tr>
<tr>
<td>Files do not match</td>
<td>2004</td>
<td>.key file does not belong to the .cer file</td>
</tr>
</tbody></table>
<h4 id='server-error-events'>Server error events</h4>
<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Signature failure</td>
<td>3002</td>
<td>Fail to sign document</td>
</tr>
</tbody></table>

<!-- Fail to request sigatures | 3001 | Fail to request signatures -->
<h2 id='embedded-signing-flow'>Embedded Signing Flow</h2>
<p>Following is a more detailed explanation of the steps involved in requesting and executing signatures within the embedded signing widget.</p>

<ol>
<li><p>The first step is to create a Document in your backend with the <em>API_ID</em> and <em>APP_SECRET</em>. You must pass the <strong>PDF file</strong> that is being signed, along with the following <strong>parameters</strong>: webhook (callback_url) and the email and name (optional) of each signer.</p></li>
<li><p>Mifiel will return a <strong>Widget ID</strong> in the response, which you will then need to pass to the widget (running on your website&#39;s front-end).</p></li>
<li><p>The signature process then takes place within your website. The signer will be able to preview the document, select the files of their FIEL, and enter the password of their FIEL to sign (during this process Mifiel will be verifying that the FIEL is valid and not expired). </p></li>
<li><p>If successful, the signer will be presented with a page explaining that the signing was successful and that they will receive an email with the signed document. We will also display a confirmation button (e.g. &#39;Proceed to next step&#39;) which will return the user to the flow of your website.</p></li>
<li><p>Mifiel will then <code>POST</code> the document information to the webhook specified by you (in Step 1): electronic signature of the document, timestamp of signature, the signature page, and information regarding the public certificate(s) used to sign the document.</p></li>
</ol>
<h1 id='endorsables-setup'>Endorsables setup</h1><h2 id='user-account-setup'>User account setup</h2>
<p>Every user (issuer or receiver) of an endorsable document must set up his account. During this setup process, we will use the user&#39;s FIEL/e.firma to derive a set of cryptocurrency addresses where the assets (the endorsable documents) will be stored.</p>

<p>The widget is an embedded tool to setup the required private keys that generate the addresses. By embedding this tool, your users can setup their account without having to leave the flow of your website.</p>

<p>The flow to embed this tool into your site is:
1. Create a Setup widget_id on our server for your user.
2. Save the widget_id in your database so you can access it later.
3. Use the widget_id in the setup-snippet. An iframe will be placed within your site where your user would drag his FIEL and a backup certificate.
4. When the setup is complete, the iframe will trigger an event so you can redirect the user to the next step in your flow.</p>
<h2 id='require-a-setup-widget-id'>Require a setup widget id</h2><h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://www.mifiel.com/api/v1/users/setup-widget</code></p>
<h3 id='parameters'>Parameters</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the user</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td><strong>Optional</strong> Tax Id (RFC) of the user</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> URL where we will POST when the user completes the process</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>widget_id</td>
<td>String</td>
<td>Widget Id to be used on the snippet</td>
</tr>
</tbody></table>

<aside class="info">
  <b>Important:</b> Save the widget_id in your database. If the user does not complete the setup, you should use the same widget_id when the user comes back to the setup flow.
</aside>
<h2 id='user-account-setup-widget'>User account setup widget</h2><h3 id='options'>Options</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>widgetId</td>
<td>String</td>
<td></td>
<td>Widget ID.</td>
</tr>
<tr>
<td>appendTo</td>
<td>String</td>
<td>body</td>
<td>ID of the element in the page</td>
</tr>
<tr>
<td>successBtnText</td>
<td>String</td>
<td>&#39;OK&#39;</td>
<td>Text of the button at the end of the setup flow. When the user clicks, will trigger an event so you can cach it.</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>37BC9B</td>
<td><strong>Optional</strong> Custom color in hexadecimal (e.g. 555555) to personalize the look and feel of your widget. Typically the primary color of your app.</td>
</tr>
<tr>
<td>width</td>
<td>String</td>
<td>100%</td>
<td><strong>Optional</strong> Width of the widget <strong>[px or %]</strong></td>
</tr>
<tr>
<td>height</td>
<td>String</td>
<td>1100</td>
<td><strong>Optional</strong> Height of the widget <strong>[px]</strong></td>
</tr>
</tbody></table>
<h3 id='events'>Events</h3>
<blockquote>
<p>Listen for Mifiel events:</p>
</blockquote>
<div class="highlight"><pre class="highlight html tab-html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="c1">// accept messages from known hosts only</span>
  <span class="c1">// change to https://app-stageex.mifiel.com if necessary</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">origin</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">https://app.mifiel.com</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// We will always send an object</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// setup completed</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">mifiel.setup-widget.success</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
        <span class="nx">doc</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nb">document</span>
  <span class="p">}</span>
  <span class="c1">// Event errors</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">mifiel.setup-widget.error</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
    <span class="c1">// error.code</span>
    <span class="c1">// error.message</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>
<p>We will send a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a> to your page to notify any of the events listed below.</p>

<p>In order to secure the events sent by the widget you <strong>must</strong> verify that the event is coming from our servers. </p>

<p>You can identify the events by <em>e.data.eventType</em>. The success event will have <strong>&quot;mifiel.setup-widget.success&quot;</strong> and the error events will have <strong>&quot;mifiel.setup-widget.error&quot;</strong>.</p>
<h3 id='success-event'>Success event</h3>
<p>We will send the document json object and the signature of the user.</p>
<h3 id='error-events'>Error events</h3>
<p>Error events have the property <em>eventType</em> set as <strong>&quot;mifiel.setup-widget.error&quot;</strong> and a error object <em>(e.data.error)</em> with <em>code</em> and <em>message</em> properties:</p>
<h4 id='user-error-events'>User error events</h4>
<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Invalid Certificate</td>
<td>2001</td>
<td>Certificate is not valid</td>
</tr>
<tr>
<td>Invalid Private Key</td>
<td>2002</td>
<td>Invalid Private Key</td>
</tr>
<tr>
<td>Invalid Pasword</td>
<td>2003</td>
<td>Invalid password</td>
</tr>
<tr>
<td>Files do not match</td>
<td>2004</td>
<td>.key file does not belong to the .cer file</td>
</tr>
</tbody></table>
<h4 id='server-error-events'>Server error events</h4>
<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Setup failure</td>
<td>3002</td>
<td>Fail to setup user</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1><h2 id='error-codes'>Error codes</h2>
<p>Mifiel API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request had an error. (more info in the <code>errors</code> response param)</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your authorization header is wrong.</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required -- Your request requires a paid plan. If you already have a plan, it may have expired.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified object could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t supported.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The requested object has been removed from our servers.</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable Entity -- Something happened when we tried to save your request.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re making too many requests! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem in our servers. Please try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>
<h2 id='error-handling'>Error Handling</h2>
<p>All errors follow the <a href="http://labs.omniti.com/labs/jsend">JSend</a> specification. Following are examples of error objects found in the body of error responses (<em>e.g. non-200 status code</em>).</p>
<h3 id='when-a-client-sends-an-unexpected-request'>When a client sends an unexpected request:</h3>
<blockquote>
<p>JSON Example <strong>fail</strong> response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fail"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Document#29f3cb01-744d-4eae-8718-213aec8a1678 not found"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code>fail</code></td>
</tr>
<tr>
<td>errors</td>
<td>Array</td>
<td>Array of error messages</td>
</tr>
</tbody></table>
<h3 id='for-server-errors'>For server errors:</h3>
<blockquote>
<p>JSON Example <strong>error</strong> response:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"error"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500: Internal Server Error"</span><span class="w"> 
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code>error</code></td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>A descriptive message</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="php">PHP</a>
                <a href="#" data-language-name="ruby">Ruby</a>
                <a href="#" data-language-name="python">Python</a>
          </div>
      </div>
    </div>
  </body>
</html>
