<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mifiel API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;,&quot;ruby&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="php">PHP</a>
              <a href="#" data-language-name="ruby">Ruby</a>
              <a href="#" data-language-name="python">Python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.mifiel.com'>Go to Mifiel.com</a></li>
            <li><a href='mailto:hola@mifiel.com'>Questions? Contact us</a></li>
            <li><a href='https://github.com/Mifiel/api-doc'>Improve this doc</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>Welcome to the Mifiel API! We at Mifiel provide a simple and robust RESTful API enabling any service or company operating in Mexico to integrate electronic signatures (using the FIEL) into their workflow.</p>

<p>Through Mifiel&rsquo;s API, you can easily manage documents and certificates within your Mifiel account.</p>

<p>We have language bindings in <strong>Shell</strong>, <strong>PHP</strong>, <strong>Ruby</strong> and <strong>Python</strong>! You can view code examples on the right (switch between different programming languages using the tabs on top).</p>

<h3 id="api-versions">API Versions</h3>

<p>All API calls are versioned, and the current Mifiel API is v1.0. We will never introduce any breaking changes within any version, but may add new, non-breaking features and enhancements from time to time.</p>

<h3 id="sandbox-enviroment">Sandbox enviroment</h3>

<p>For your convenience Mifiel offers a Sandbox environment where you can confidently test your code.</p>

<p>To start using the API in the <strong>Sandbox</strong> environment you need to first create an account at <a href="https://sandbox.mifiel.com">sandbox.mifiel.com</a>.</p>

<p>Once you have an account you will need an <em>APP_ID</em> and an <em>APP_SECRET</em> which you can generate in <a href="https://sandbox.mifiel.com/access_tokens">sandbox.mifiel.com/access_tokens</a>.</p>

<p>Just change the <strong>www</strong>.mifiel.com for <strong>sandbox</strong>.mifiel.com in every endpoint that you use.</p>

<aside class="warning">
  Documents signed in the Sandobox environment are legally invalid and should not be used for legal purposes.
</aside>

<h3 id="production-enviroment">Production enviroment</h3>

<p>To start using the API in the <strong>Production</strong> environment you need to first create an account at <a href="https://www.mifiel.com">mifiel.com</a>.</p>

<p>Once you have an account you will need an <em>APP_ID</em> and a <em>APP_SECRET</em> which you can generate in <a href="https://www.mifiel.com/access_tokens">mifiel.com/access_tokens</a>.</p>

<h2 id="mifiel-supported-sdks">Mifiel-supported SDKs</h2>

<p>We currently suppport <strong>Ruby</strong>, <strong>PHP</strong> and <strong>Python</strong> but are working on adding more languages.</p>

<h3 id="ruby">Ruby</h3>
<pre class="highlight ruby"><code><span class="c1"># Configure Mifiel gem</span>
<span class="no">Mifiel</span><span class="p">.</span><span class="nf">config</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="k">end</span>
</code></pre>

<p>Add this line to your application&rsquo;s Gemfile:</p>

<p><code class="prettyprint">gem &#39;mifiel&#39;</code></p>

<p>Then execute:</p>

<p><code class="prettyprint">$ bundle</code></p>

<p>Or install it yourself as:</p>

<p><code class="prettyprint">$ gem install mifiel</code></p>

<p>You can find the repo at <a href="https://github.com/Mifiel/ruby-api-client">github.com/Mifiel/ruby-api-client</a>.</p>

<h3 id="php">PHP</h3>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="c1">// include composer autoload
</span><span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>

<span class="c1">// import Mifiel Client Class
</span><span class="k">use</span> <span class="nx">Mifiel\ApiClient</span> <span class="k">as</span> <span class="nx">Mifiel</span><span class="p">;</span>

<span class="c1">// Configure Mifiel Library
</span><span class="nx">Mifiel</span><span class="o">::</span><span class="na">setTokens</span><span class="p">(</span><span class="s1">'APP_ID'</span><span class="p">,</span> <span class="s1">'APP_SECRET'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>

<p>The best way to install Mifiel is quickly and easily with <a href="https://getcomposer.org">Composer</a>.</p>

<p>To install the most recent version, run the following command.</p>

<p><code class="prettyprint">php composer.phar require mifiel/api-client</code> </p>

<p>Now your composer.json has been updated automatically and you&rsquo;re able to require the just created <em>vendor/autoload.php</em> file to PSR-4 autoload the library.</p>

<p>You can find the repo at <a href="https://github.com/Mifiel/php-api-client">github.com/Mifiel/ruby-api-client</a>.</p>

<h3 id="python">Python</h3>
<pre class="highlight python"><code><span class="c"># Import the Client </span>
<span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="c"># Configure Mifiel Library, you will </span>
<span class="c"># pass this to every call you make to our servers.</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>
<span class="c"># If you want to make tests without beeing charged</span>
<span class="c"># you can use our sandbox enviroment with:</span>
<span class="n">client</span><span class="o">.</span><span class="n">use_sandbox</span>
</code></pre>

<p>The best way to install Mifiel lib is with <a href="https://pypi.python.org/pypi">PIP</a>.
To install the most recent version please run the following command.</p>

<p><code class="prettyprint">pip install mifiel</code></p>

<p>You can find the repo at <a href="https://github.com/Mifiel/python-api-client/">github.com/Mifiel/python-api-client</a></p>

<h2 id="authentication">Authentication</h2>

<p>Mifiel uses <strong>SHA1 HMAC encryption</strong> to authenticate API calls. Each request has to be authenticated by following these steps:</p>

<ol>
<li>A canonical string is first created using your HTTP headers containing the
content-type, content-MD5, request URI and the timestamp. You can replace content-type and content-MD5 with a blank string if needed. The timestamp must be a valid HTTP date. The canonical string is computed as follows:</li>
</ol>

<p><code class="prettyprint">canonical_string = &#39;http method,content-type,content-MD5,request URI,timestamp&#39;</code></p>

<ol>
<li><p>This string is then used to create the signature, which is a Base64 encoded
SHA1 HMAC, using the <strong>APP_SECRET</strong> key.</p></li>
<li><p>This signature is then added as the <code class="prettyprint">Authorization</code> HTTP header in the following form:</p></li>
</ol>

<p><code class="prettyprint">Authorization: APIAuth APP-ID:signature-from-step-2</code></p>
<pre class="highlight ruby"><code><span class="n">app_id</span> <span class="o">=</span> <span class="s1">'&lt;APP_ID&gt;'</span>
<span class="n">app_secret</span> <span class="o">=</span> <span class="s1">'&lt;APP_SECRET&gt;'</span>
<span class="n">rest_request</span> <span class="o">=</span> <span class="no">RestClient</span><span class="o">::</span><span class="no">Request</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="ss">url: </span><span class="s1">'https://www.mifiel.com/api/v1/documents'</span><span class="p">,</span>
  <span class="ss">method: :get</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="no">ApiAuth</span><span class="p">.</span><span class="nf">sign!</span><span class="p">(</span><span class="n">rest_request</span><span class="p">,</span> <span class="n">app_id</span><span class="p">,</span> <span class="n">app_secret</span><span class="p">).</span><span class="nf">execute</span>
<span class="n">json_response</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre>

<h3 id="ruby-example">Ruby Example</h3>

<p>If you are using Ruby, we recommend using our <a href="https://github.com/Mifiel/ruby-api-client">official gem</a>. </p>

<p>If you want to create your own, you can use the <a href="https://github.com/mgomes/api_auth/">api-auth</a> gem which supports many popular HTTP clients. In this example we are using the <a href="https://github.com/rest-client/rest-client">RestClient</a> gem. </p>

          <h1 id="objects">Objects</h1>

<p>Mifiel data is structured around 3 main types of objects: Document, Certificate and Signature. Youâ€™ll find these objects in the format described below.</p>

<aside class="info">
  The <b>Date</b> type is always in <b>Coordinated Universal Time (UTC)</b>.
</aside>

<h2 id="document">Document</h2>

<p>Contains information about the PDF file being signed</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"original_hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1a580c27d22b4...c537bf90282a6889da"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-pdf.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_by_all"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.921Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Firmado"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.example.com/webhook/url"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_signed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file_signed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_signed_download"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../file_signed?download=true"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"file_zipped"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/v1/documents/.../zip"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"certificate_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jorge Morales"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>original_hash</td>
<td>String</td>
<td>Hash of the original (unsigned) document</td>
</tr>
<tr>
<td>file_file_name</td>
<td>String</td>
<td>Name of the uploaded file</td>
</tr>
<tr>
<td>signed_by_all</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if all signers have signed the document</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of date signed (when all signatures have been collected)</td>
</tr>
<tr>
<td>already_signed</td>
<td>String[]</td>
<td>People that have signed</td>
</tr>
<tr>
<td>has_not_signed</td>
<td>String[]</td>
<td>People that have not signed</td>
</tr>
<tr>
<td>status</td>
<td>Array</td>
<td>[code, code_message] <code class="prettyprint">0: not signed, 1: signed</code></td>
</tr>
<tr>
<td>owner</td>
<td>Object</td>
<td>The owner of the document. The user who created the document.</td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td>The callback URL to be <code class="prettyprint">POST</code>ed when everybody signs</td>
</tr>
<tr>
<td>file</td>
<td>String</td>
<td>Path where the original document can be downloaded</td>
</tr>
<tr>
<td>file_signed</td>
<td>String</td>
<td>Path where the signed file can be downloaded</td>
</tr>
<tr>
<td>file_zipped</td>
<td>String</td>
<td>Path where the file and signed file in a zip file can be downloaded</td>
</tr>
<tr>
<td>signatures</td>
<td>Object[]</td>
<td>Array of a <a href="#signature">Signature Model</a></td>
</tr>
</tbody></table>

<h2 id="certificate">Certificate</h2>

<p>Contains information regarding the advanced electronic signatures (e.g. FIEL) used to sign the document</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07320f00-f504-47e0-8ff6-78378d2faca4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type_of"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FIEL"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cer_hex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"308204cf30...1303030303030323"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JORGE MORALES MENDEZ"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MOMJ811012643"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-28T19:43:23.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate</td>
</tr>
<tr>
<td>type_of</td>
<td>String</td>
<td>Type of certificate used (e.g. FIEL)</td>
</tr>
<tr>
<td>owner</td>
<td>String</td>
<td>Name of the owner as defined in the certificate</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC (tax ID) or other identifier of owner as defined in the certificate</td>
</tr>
<tr>
<td>cer_hex</td>
<td>String</td>
<td>Certificate in hexadecimal</td>
</tr>
<tr>
<td>expires_at</td>
<td>Date</td>
<td>Expiration date of the Certificate</td>
</tr>
<tr>
<td>expired</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if the Certificate is expired</td>
</tr>
</tbody></table>

<h2 id="signature">Signature</h2>

<p>Contains information regarding the signers that have successfully signed the document</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T16:34:37.887Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"certificate_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20001000000200001410"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AAA010101AAA"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77cd5156779c..4e276ef1056c1de11b7f70bed28"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signer1@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signer 1"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>The ID of the Certificate used to sign</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>signed</td>
<td>Boolean</td>
<td><code class="prettyprint">true</code> if signed</td>
</tr>
<tr>
<td>signed_at</td>
<td>Date</td>
<td>Timestamp of the date signed</td>
</tr>
<tr>
<td>certificate_number</td>
<td>String</td>
<td>Certificate number assigned by the certificate authority (e.g. SAT)</td>
</tr>
<tr>
<td>tax_id</td>
<td>String</td>
<td>RFC of the signer</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Electronic signature on the document (in hexadecimal)</td>
</tr>
</tbody></table>

          <h1 id="documents">Documents</h1>

<h2 id="create-a-document">Create a Document</h2>

<blockquote>
<p>Send only <strong>original_hash</strong> and <strong>name</strong> if you dont want us to have the document.</p>
</blockquote>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">file: </span><span class="s1">'path/to/my-file.pdf'</span><span class="p">,</span>
  <span class="ss">signatories: </span><span class="p">[</span>
    <span class="p">{</span> 
      <span class="ss">name: </span><span class="s1">'Signer 1'</span><span class="p">,</span> 
      <span class="ss">email: </span><span class="s1">'signer1@email.com'</span><span class="p">,</span> 
      <span class="ss">tax_id: </span><span class="s1">'AAA010101AAA'</span> 
    <span class="p">},</span> 
    <span class="p">{</span> 
      <span class="ss">name: </span><span class="s1">'Signer 2'</span><span class="p">,</span> 
      <span class="ss">email: </span><span class="s1">'signer2@email.com'</span><span class="p">,</span> 
      <span class="ss">tax_id: </span><span class="s1">'AAA010102AAA'</span> 
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="ss">callback_url: </span><span class="s1">'https://www.example.com/webhook/url'</span>
<span class="p">)</span>

<span class="c1"># if you dont want us to have the PDF, you can send us </span>
<span class="c1"># the original_hash and the name of the document. Both are required</span>
<span class="n">file_contents</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="s1">'path/to/my-file.pdf'</span><span class="p">)</span>
<span class="n">original_hash</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(</span><span class="n">file_contents</span><span class="p">)</span>
<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">original_hash: </span><span class="n">original_hash</span><span class="p">,</span>
  <span class="ss">name: </span><span class="s1">'my-file.pdf'</span>
  <span class="ss">signatories: </span><span class="p">[</span> <span class="p">.</span><span class="nf">.</span><span class="o">.</span> <span class="p">]</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST https://www.mifiel.com/api/v1/documents <span class="se">\</span>
  -F <span class="s2">"file=@my-file.pdf"</span> <span class="se">\</span>
  -F <span class="s2">"signatories[0][name]=Signer 1"</span> <span class="se">\</span>
  -F <span class="s2">"signatories[0][email]=signer@email.com"</span> <span class="se">\</span>
  -F <span class="s2">"callback_url=https://www.example.com/webhook/url"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Document</span><span class="p">([</span>
  <span class="s1">'file_path'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/my-file.pdf'</span><span class="p">,</span>
  <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="p">[</span> 
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Signer 1'</span><span class="p">,</span> 
      <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'signer1@email.com'</span><span class="p">,</span> 
      <span class="s1">'tax_id'</span> <span class="o">=&gt;</span>  <span class="s1">'AAA010101AAA'</span> 
    <span class="p">],</span>
    <span class="p">[</span> 
      <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Signer 2'</span><span class="p">,</span> 
      <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'signer2@email.com'</span><span class="p">,</span> 
      <span class="s1">'tax_id'</span> <span class="o">=&gt;</span>  <span class="s1">'AAA010102AAA'</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">]);</span>
<span class="c1">// if you dont want us to have the PDF, you can just send us 
// the original_hash and the name of the document. Both are required
</span><span class="nv">$document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Document</span><span class="p">([</span>
  <span class="s1">'original_hash'</span> <span class="o">=&gt;</span> <span class="nb">hash</span><span class="p">(</span><span class="s1">'sha256'</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'path/to/my-file.pdf'</span><span class="p">)),</span>
  <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'my-file.pdf'</span><span class="p">,</span>
  <span class="s1">'signatories'</span> <span class="o">=&gt;</span> <span class="o">...</span>
<span class="p">]);</span>

<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">signatories</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> 
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Signer 1'</span><span class="p">,</span> 
    <span class="s">'email'</span><span class="p">:</span> <span class="s">'signer1@email.com'</span><span class="p">,</span> 
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010101AAA'</span> 
  <span class="p">},</span>
  <span class="p">{</span> 
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Signer 2'</span><span class="p">,</span> 
    <span class="s">'email'</span><span class="p">:</span> 
    <span class="s">'signer2@email.com'</span><span class="p">,</span> 
    <span class="s">'tax_id'</span><span class="p">:</span> <span class="s">'AAA010102AAA'</span>
  <span class="p">}</span>
<span class="p">]</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> 
  <span class="n">signatories</span><span class="o">=</span><span class="n">signatories</span><span class="p">,</span> 
  <span class="nb">file</span><span class="o">=</span><span class="s">'test/fixtures/example.pdf'</span>
<span class="p">)</span>
<span class="c"># if you dont want us to have the PDF, you can just send us </span>
<span class="c"># the original_hash and the name of the document. Both are required</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> 
  <span class="n">signatories</span><span class="o">=</span><span class="n">signatories</span><span class="p">,</span> 
  <span class="n">dhash</span><span class="o">=</span><span class="s">'some-sha256-hash'</span>
<span class="p">)</span>
</code></pre>

<p>Create a document to be signed by passing either a PDF file or the Hash of the file.</p>

<p>If you are using our <a href="#widget">embedded signing widget</a>, we suggest that you pass a <strong>File</strong> so that it can be displayed to the end user (signer) within the signing flow on your webpage. Also when using the widget you must pass the <strong>email of the signer</strong> (name is optional) so that we can send them a copy of the signed document when the signing process is complete.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/documents</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td><strong>Optional</strong> File to be signed (The hash will be automatically extracted from the file and signed)</td>
</tr>
<tr>
<td>original_hash</td>
<td>String</td>
<td><strong>Optional</strong> <em>SHA256 encoded</em> Hash of the original, unsigned document (The hash will be signed)</td>
</tr>
<tr>
<td>signatories</td>
<td>Array</td>
<td>A list containing the <strong>name</strong>, <strong>tax_id</strong> (RFC) and <strong>email</strong> of each <strong>signer</strong></td>
</tr>
<tr>
<td>callback_url</td>
<td>String</td>
<td><strong>Optional</strong> A Callback URL to post when the document gets signed</td>
</tr>
</tbody></table>

<aside class="info">
  <ul style="margin: 0; padding: 0">
    <li>Either the <b>file</b> or <b>original_hash</b> must be passed.</li>
    <li>The <b>email</b> in the <b>signatories</b> param is <b>required</b> when using embedded signing.</li>
  </ul>
</aside>

<h3 id="response">Response</h3>

<p>Returns a <a href="#document">Document Model</a></p>

<h2 id="get-a-specific-document">Get a Specific Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="nf">original_hash</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file</span>
<span class="n">document</span><span class="p">.</span><span class="nf">file_signed</span>
<span class="n">document</span><span class="p">.</span><span class="nf">widget_id</span>
<span class="c1"># ...</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">original_hash</span><span class="p">;</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">;</span>
<span class="nv">$document</span><span class="o">-&gt;</span><span class="na">file_signed</span><span class="p">;</span>
<span class="c1"># ...
</span><span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'id'</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">original_hash</span>
<span class="n">document</span><span class="o">.</span><span class="nb">file</span>
<span class="n">document</span><span class="o">.</span><span class="n">file_signed</span>
<span class="c"># ...</span>
</code></pre>

<p>Allows you to retrieve a specific document.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/documents/:id</code></p>

<h3 id="response">Response</h3>

<p>Returns a <a href="#document">Document Models</a></p>

<h2 id="get-all-documents">Get All Documents</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">documents</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">all</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/documents"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Document</span><span class="p">;</span>

<span class="nv">$documents</span> <span class="o">=</span> <span class="nx">Document</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">documents</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</code></pre>

<p>Allows you to retrieve all documents in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/documents</code></p>

<h3 id="response">Response</h3>

<p>Returns an Array of <a href="#document">Document Model</a></p>

<h2 id="delete-a-document">Delete a Document</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X DELETE <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Document</span><span class="p">;</span>

<span class="nx">Document</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">Document</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
</code></pre>

<p>Allows you to delete a specific document in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://www.mifiel.com/api/v1/documents/:id</code></p>

<h2 id="request-signature">Request signature</h2>

<p>Sends an email request for the document to be signed.</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">document</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">email</span> <span class="o">=</span> <span class="s1">'signer@email.com'</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'signer@email.com'</span><span class="p">,</span> <span class="s1">'viewer@email.com'</span><span class="p">]</span>
<span class="n">document</span><span class="p">.</span><span class="nf">request_signature</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="ss">cc: </span><span class="n">cc</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST <span class="s2">"https://www.mifiel.com/api/v1/documents/29f3cb01-744d-4eae-8718-213aec8a1678/request_signature"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">from</span> <span class="nn">mifiel</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s">'APP_ID'</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="s">'APP_SECRET'</span><span class="p">)</span>

<span class="n">email</span> <span class="o">=</span> <span class="s">'signer@email.com'</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="s">'signer@email.com'</span><span class="p">,</span> <span class="s">'viewer@email.com'</span><span class="p">]</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s">'29f3cb01-744d-4eae-8718-213aec8a1678'</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">request_signature</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">cc</span><span class="o">=</span><span class="n">cc</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Response from Mifiel:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Correo enviado"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29f3cb01-744d-4eae-8718-213aec8a1678"</span><span class="w">        
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/documents/:id/request_signature</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>Email of the signer</td>
</tr>
<tr>
<td>cc</td>
<td>String</td>
<td>Email of any non-signing viewers that should receive a copy of the signed document</td>
</tr>
</tbody></table>

          <h1 id="certificates">Certificates</h1>

<p>At the moment we only support signing with the FIEL (the most frequently used advanced electronic signature in Mexico). We will  soon be adding support for additional types of electronic signatures and will update the documentation as we do so.</p>

<h2 id="create-a-certificate">Create a Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">file: </span><span class="s1">'path/to/my-certificate.cer'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X POST https://www.mifiel.com/api/v1/keys <span class="se">\</span>
  -F <span class="s2">"file=@my-certificate.cer"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Certificate</span><span class="p">([</span>
  <span class="s1">'file'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/my-certificate.cer'</span>
<span class="p">])</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre>

<p>Uploads the certificate of a signer in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://www.mifiel.com/api/v1/keys</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>String</td>
<td><code class="prettyprint">.cer</code> File of your FIEL</td>
</tr>
</tbody></table>

<aside class="info">
  You only have to send the public certificate of the signer. We will never store the private key in our servers.
</aside>

<h3 id="response">Response</h3>

<p>Returns a <a href="#certificate">Certificate Model</a></p>

<h2 id="get-a-specific-certificate">Get a Specific Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificate</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">type_of</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">owner</span>
<span class="n">certificate</span><span class="p">.</span><span class="nf">tax_id</span>
<span class="c1"># ...</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mfiel.com.mx/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificate</span> <span class="o">=</span> <span class="nx">Certificate</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">);</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">cer_hex</span><span class="p">;</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">type_of</span><span class="p">;</span>
<span class="nv">$certificate</span><span class="o">-&gt;</span><span class="na">owner</span><span class="p">;</span>
<span class="c1"># ...
</span><span class="cp">?&gt;</span>
</code></pre>

<p>Allows you to retrieve a specific certificate.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/keys/:id</code></p>

<h3 id="response">Response</h3>

<p>Returns a <a href="#certificate">Certificate Model</a></p>

<h2 id="get-all-certificates">Get All Certificates</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="n">certificates</span> <span class="o">=</span> <span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">all</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://www.mifiel.com/api/v1/keys"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Certificate</span><span class="p">;</span>

<span class="nv">$certificates</span> <span class="o">=</span> <span class="nx">Certificate</span><span class="o">::</span><span class="na">all</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</code></pre>

<p>Allows you to retrieve ALL certificates in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://www.mifiel.com/api/v1/keys</code></p>

<h3 id="response">Response</h3>

<p>Returns an Array of a <a href="#certificate">Certificate Model</a></p>

<h2 id="delete-a-certificate">Delete a Certificate</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'mifiel'</span>

<span class="no">Mifiel</span><span class="o">::</span><span class="no">Certificate</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s1">'07320f00-f504-47e0-8ff6-78378d2faca4'</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl -X DELETE <span class="s2">"https://www.mifiel.com/api/v1/keys/07320f00-f504-47e0-8ff6-78378d2faca4"</span>
  -H <span class="s2">"Authorization: APIAuth APP-ID:hmac-signature"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Mifiel\Certificate</span><span class="p">;</span>

<span class="nx">Certificate</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>

<p>Allows you to delete a specific certificate in your account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://www.mifiel.com/api/v1/keys/:id</code></p>

          <h1 id="embedded-signing">Embedded Signing</h1>

<h2 id="widget">Widget</h2>

<blockquote>
<p>Copy this code and paste it just before the <b>&lt;/body&gt;</b> tag.</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="o">||</span><span class="p">[],</span><span class="kd">function</span><span class="p">(){</span><span class="s2">"use strict"</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">[</span><span class="s2">"widget"</span><span class="p">],</span><span class="nx">i</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(){</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">e</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)))}},</span><span class="nx">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">t</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">t</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">t</span><span class="p">];</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">n</span><span class="p">))}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"mifiel-js"</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"script"</span><span class="p">),</span><span class="nx">o</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"script"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="nx">r</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">"text/javascript"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="s2">"mifiel-js"</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">async</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">"https://www.mifiel.com/sign-widget-v1.0.0.js"</span><span class="p">,</span><span class="nx">o</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">o</span><span class="p">)}}();</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<blockquote>
<p>Then insert the widget in the desired view (page) by including the following snippet:</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mifiel</span><span class="p">.</span><span class="nx">widget</span><span class="p">({</span>
    <span class="na">widgetId</span><span class="p">:</span> <span class="s1">'c8aa73d1-db06-4d18-9f56-196b00f6eb69'</span><span class="p">,</span>
    <span class="na">appendTo</span><span class="p">:</span> <span class="s1">'id-of-the-element-to-append'</span><span class="p">,</span>
    <span class="na">successBtnText</span><span class="p">:</span> <span class="s1">'Proceed to next step'</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>The widget is an embedded signing tool that we have created to allow your users to sign documents in an iFrame within your page. By embedding this tool, your users can sign seamlessly without having to leave the flow of your website.</p>

<p><em>Note: The signers do not have to have an account in <a href="https://www.mifiel.com">mifiel.com</a></em></p>

<p>To begin, you have to copy and paste our code snippet (<em>shown to your right</em>) into the code of the page where the signing flow will take place.</p>

<p>You can also find the code snippet <a href="https://www.mifiel.com/sign-snippet-v1.0.0.min.js">here</a>.</p>

<h3 id="options">Options</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>widgetId</td>
<td>String</td>
<td></td>
<td>Widget ID. You can get it with <code class="prettyprint">document.widget_id</code> in Ruby</td>
</tr>
<tr>
<td>appendTo</td>
<td>String</td>
<td>body</td>
<td>ID of the element in the page</td>
</tr>
<tr>
<td>successBtnText</td>
<td>String</td>
<td>&lsquo;OK&rsquo;</td>
<td>Text of the button at the end of the signing flow. When the user click</td>
</tr>
<tr>
<td>pdf</td>
<td>Base64</td>
<td>null</td>
<td><strong>Optional</strong> PDF in Base64 if you did not send us the PDF when you created the document.</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>37BC9B</td>
<td><strong>Optional</strong> Custom color in hexadecimal (e.g. 555555) to personalize the look and feel of your widget. Typically the primary color of your app.</td>
</tr>
<tr>
<td>width</td>
<td>String</td>
<td>100%</td>
<td><strong>Optional</strong> Width of the widget <strong>[px or %]</strong></td>
</tr>
<tr>
<td>height</td>
<td>String</td>
<td>1100</td>
<td><strong>Optional</strong> Height of the widget <strong>[px]</strong></td>
</tr>
</tbody></table>

<h2 id="events">Events</h2>

<blockquote>
<p>Listen for Mifiel events:</p>
</blockquote>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="c1">// accept messages from known hosts only</span>
  <span class="c1">// change to https://stageex.mifiel.com if necessary</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">origin</span> <span class="o">!==</span> <span class="s1">'https://www.mifiel.com'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// We will always send an object</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="o">!==</span> <span class="s1">'object'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// document signed succesfully</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="s1">'mifiel.widget.success'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
        <span class="nx">doc</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
        <span class="nx">signature</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">signature</span><span class="p">;</span>
    <span class="c1">// doc.original_hash;</span>
    <span class="c1">// doc.file_signed;</span>
  <span class="p">}</span>
  <span class="c1">// Event errors</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">eventType</span> <span class="o">===</span> <span class="s1">'mifiel.widget.error'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
    <span class="c1">// error.code =&gt; 1001</span>
    <span class="c1">// error.message =&gt; 'Invalid PDF, the pdf param has no data'</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>We will send a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a> to your page to notify any of the events listed below.</p>

<p>In order to secure the events sent by the widget you <strong>must</strong> verify that the event is coming from our servers. </p>

<p>You can identify the events by <em>e.data.eventType</em>. The success event will have <strong>&ldquo;mifiel.widget.success&rdquo;</strong> and the error events will have <strong>&ldquo;mifiel.widget.error&rdquo;</strong>.</p>

<h3 id="success-event">Success event</h3>

<p>We will send the document json object and the signature of the user.</p>

<h3 id="error-events">Error events</h3>

<p>Error events have the property <em>eventType</em> set as <strong>&ldquo;mifiel.widget.error&rdquo;</strong> and a error object <em>(e.data.error)</em> with <em>code</em> and <em>message</em> properties:</p>

<h4 id="widget-setup-error-events">Widget setup error events</h4>

<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Empty PDF</td>
<td>1001</td>
<td>Invalid PDF, the pdf param has no data</td>
</tr>
<tr>
<td>Hashes do not match</td>
<td>1002</td>
<td>Invalid PDF, the provided pdf param is not the same as the uploaded one</td>
</tr>
</tbody></table>

<p><em>Note: We send this errors only when you did not send us the PDF when the document was created.</em></p>

<h4 id="user-error-events">User error events</h4>

<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Invalid Certificate</td>
<td>2001</td>
<td>Certificate is not valid</td>
</tr>
<tr>
<td>Invalid Private Key</td>
<td>2002</td>
<td>Invalid Private Key</td>
</tr>
<tr>
<td>Invalid Pasword</td>
<td>2003</td>
<td>Invalid password</td>
</tr>
<tr>
<td>Files do not match</td>
<td>2004</td>
<td>.key file does not belong to the .cer file</td>
</tr>
</tbody></table>

<h4 id="server-error-events">Server error events</h4>

<table><thead>
<tr>
<th>Event</th>
<th>Code</th>
<th>Message</th>
</tr>
</thead><tbody>
<tr>
<td>Signature failure</td>
<td>3002</td>
<td>Fail to sign document</td>
</tr>
</tbody></table>

<!-- Fail to request sigatures | 3001 | Fail to request signatures -->

<h2 id="embedded-signing-flow">Embedded Signing Flow</h2>

<p>Following is a more detailed explanation of the steps involved in requesting and executing signatures within the embedded signing widget.</p>

<ol>
<li><p>The first step is to create a Document in your backend with the <em>API_ID</em> and <em>APP_SECRET</em>. You must pass the <strong>PDF file</strong> that is being signed (or a SHA256 encoded hash of the PDF and the name of the file), along with the following <strong>parameters</strong>: webhook (callback_url) and the email and name (optional) of each signer.</p></li>
<li><p>Mifiel will return a <strong>Widget ID</strong> in the response, which you will then need to pass to the widget (running on your website&rsquo;s front-end).</p></li>
<li><p>The signature process then takes place within your website. The signer will be able to preview the document, select the files of their FIEL, and enter the password of their FIEL to sign (during this process Mifiel will be verifying that the FIEL is valid and not expired). </p></li>
<li><p>If successful, the signer will be presented with a page explaining that the signing was successful and that they will receive an email with the signed document. We will also display a confirmation button (e.g. &#39;Proceed to next step&rsquo;) which will return the user to the flow of your website.</p></li>
<li><p>Mifiel will then <code class="prettyprint">POST</code> the document information to the webhook specified by you (in Step 1): electronic signature of the document, timestamp of signature, the signature page, and information regarding the public certificate(s) used to sign the document.</p></li>
</ol>

          <h1 id="errors">Errors</h1>

<h2 id="error-codes">Error codes</h2>

<p>Mifiel API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request had an error. (more info in the <code class="prettyprint">errors</code> response param)</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your authorization header is wrong.</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required &ndash; Your request requires a paid plan. If you already have a plan, it may have expired.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified object could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t supported.</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The requested object has been removed from our servers.</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable Entity &ndash; Something happened when we tried to save your request.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re making too many requests! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem in our servers. Please try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

<h2 id="error-handling">Error Handling</h2>

<p>All errors follow the <a href="http://labs.omniti.com/labs/jsend">JSend</a> specification. Following are examples of error objects found in the body of error responses (<em>e.g. non-200 status code</em>).</p>

<h3 id="when-a-client-sends-an-unexpected-request">When a client sends an unexpected request:</h3>

<blockquote>
<p>JSON Example <strong>fail</strong> response:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fail"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Document#29f3cb01-744d-4eae-8718-213aec8a1678 not found"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code class="prettyprint">fail</code></td>
</tr>
<tr>
<td>errors</td>
<td>Array</td>
<td>Array of error messages</td>
</tr>
</tbody></table>

<h3 id="for-server-errors">For server errors:</h3>

<blockquote>
<p>JSON Example <strong>error</strong> response:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"error"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500: Internal Server Error"</span><span class="w"> 
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>String</td>
<td><code class="prettyprint">error</code></td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>A descriptive message</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="php">PHP</a>
                <a href="#" data-language-name="ruby">Ruby</a>
                <a href="#" data-language-name="python">Python</a>
          </div>
      </div>
    </div>
  </body>
</html>
